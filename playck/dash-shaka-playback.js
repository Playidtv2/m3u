!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("Clappr")):"function"==typeof define&&define.amd?define(["Clappr"],e):"object"==typeof exports?exports.DashShakaPlayback=e(require("Clappr")):t.DashShakaPlayback=e(t.Clappr)}(this,function(t){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function(t,e,i){for(var n=!0;n;){var r=t,s=e,a=i;n=!1,null===r&&(r=Function.prototype);var o=Object.getOwnPropertyDescriptor(r,s);if(void 0!==o){if("value"in o)return o.value;var h=o.get;return void 0===h?void 0:h.call(a)}var u=Object.getPrototypeOf(r);if(null===u)return void 0;t=u,e=s,i=a,n=!0,o=u=void 0}},h=i(2),u=i(1),l=n(u),c=3e4,f=function(t){function e(t){var i=this;r(this,e),o(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this._readyToPlay=!1;var n=function(t){return function(e){return i._readyToPlay?t(e):void 0}};this.enableTextTrack=n(function(t){return i._player.enableTextTrack(t)}),this.textTracks=n(function(){return i._player.getTextTracks()}),this.selectTextTrack=n(function(t){return i._player.selectTextTrack(t)}),this.audioTracks=n(function(){return i._player.getAudioTracks()}),this.selectAudioTrack=n(function(t){return i._player.selectAudioTrack(t)}),this.videoTracks=n(function(){return i._player.getVideoTracks()}),this.selectVideoTrack=n(function(t){return i._player.selectVideoTrack(t)}),this.getPlaybackType=n(function(){return i._player.isLive()?"live":"vod"})}return s(e,t),a(e,[{key:"name",get:function(){return"dash_shaka_playback"}},{key:"shakaVersion",get:function(){return l["default"].player.Player.version}}]),a(e,[{key:"play",value:function(){return!this._player&&this._setup(),this._readyToPlay?void o(Object.getPrototypeOf(e.prototype),"play",this).call(this):void this.once(h.Events.PLAYBACK_READY,this.play)}},{key:"ready",value:function(){}},{key:"error",value:function(t){h.Log.error("an error was raised by the video tag",t,this.el.error)}},{key:"isHighDefinitionInUse",value:function(){return!!this.highDefinition}},{key:"stop",value:function(){clearInterval(this.sendStatsId),this.trigger(h.Events.CONTAINER_STOP,this.name),this._sendStats(),this._player.unload(),this._player=null,this._readyToPlay=!1}},{key:"destroy",value:function(){var t=this;clearInterval(this.sendStatsId),this._player.destroy().then(function(){return t._destroy()})["catch"](function(){t._destroy(),h.Log.error("shaka could not be destroyed")})}},{key:"_setup",value:function(){var t=this;this._player=this._createPlayer();var e=this._player.load(new l["default"].player.DashVideoSource(this.options.src));e.then(function(){return t._loaded()})["catch"](function(e){return t._setupError(e)})}},{key:"_createPlayer",value:function(){var t=this,e=new l["default"].player.Player(this.el);return e.addEventListener("bufferingStart",function(){return t._bufferingHandler()}),e.addEventListener("bufferingEnd",function(){return t._bufferingFullHandler()}),e.addEventListener("error",function(e){return t._error(e)}),e.addEventListener("adaptation",function(){return t._onAdaptation()}),e}},{key:"_loaded",value:function(){this._ready(),this._startToSendStats()}},{key:"_startToSendStats",value:function(){var t=this;this.sendStatsId=setInterval(function(){return t._sendStats()},c)}},{key:"_sendStats",value:function(){this.trigger(h.Events.PLAYBACK_STATS_ADD,this._player.getStats())}},{key:"_setupError",value:function(t){this._error({detail:"shaka could not be setup: "+t})}},{key:"_bufferingHandler",value:function(){this.trigger(h.Events.PLAYBACK_BUFFERING,this.name)}},{key:"_bufferingFullHandler",value:function(){this.trigger(h.Events.PLAYBACK_BUFFERFULL,this.name)}},{key:"_error",value:function(t){h.Log.error("an error was raised by shaka player",t.detail),this.trigger(h.Events.PLAYBACK_ERROR,t.detail,this.name)}},{key:"_onAdaptation",value:function(t){t.size||(h.Log.debug("an adaptation has happened:",t),this.highDefinition=t.size.height>=720,this.trigger(h.Events.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinition),this.trigger(h.Events.PLAYBACK_BITRATE,{bitrate:t.size.height}))}},{key:"_destroy",value:function(){o(Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this._readyToPlay=!1,h.Log.debug("shaka was destroyed")}},{key:"_ready",value:function(){this._readyToPlay=!0,o(Object.getPrototypeOf(e.prototype),"ready",this).call(this)}}]),e}(h.HTML5Video);e["default"]=f,f.canPlay=function(t,e){if(l["default"].polyfill.installAll(),!l["default"].player.Player.isBrowserSupported())return h.Log.debug("This browser does not support this video"),!1;var i=t.split("?")[0].match(/.*\.(.*)$/)||[];return"mpd"===i[1]},t.exports=e["default"]},function(t,e,i){var n;!function(){var r={};(function(t){function e(t,e){var i=t.split("."),n=Ir;i[0]in n||!n.execScript||n.execScript("var "+i[0]);for(var r;i.length&&(r=i.shift());)i.length||void 0===e?n=n[r]?n[r]:n[r]={}:n[r]=e}function i(t,e){function i(){}i.prototype=e.prototype,t.Ob=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.Mb=function(t,i,n){return e.prototype[i].apply(t,Array.prototype.slice.call(arguments,2))}}function n(t,e){this.id=t,this.lang=e||"unknown",this.enabled=this.active=!1}function r(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.maxHeight=null}function s(t,e,i,n){this.id=t,this.bandwidth=e||0,this.width=i||0,this.height=n||0,this.active=!1}function a(t,e){var i=t.width*t.height,n=e.width*e.height;return n>i?-1:i>n?1:t.bandwidth<e.bandwidth?-1:t.bandwidth>e.bandwidth?1:0}function o(t,e,i){this.id=t,this.bandwidth=e||0,this.lang=i||"unknown",this.active=!1}function h(){var t,e,i=new Promise(function(i,n){t=i,e=n});return i.resolve=t,i.reject=e,i.destroy=h.prototype.destroy,i}function u(t,e){return e.bind(t)}function l(t){return Object.keys(t).map(function(e){return t[e]})}function c(t,e){var i=p(t,e,"number");if(null==i)return null;if(isNaN(i)||i==Number.NEGATIVE_INFINITY||i==Number.POSITIVE_INFINITY)throw new RangeError("'"+e+"' must be finite.");if(0>i)throw new RangeError("'"+e+"' must be >= 0");return i}function f(t,e){return p(t,e,"string")}function p(t,e,i){if(t=t[e],null==t)return null;if(typeof t!=i)throw new TypeError("'"+e+"' must be a "+i+".");return t}function d(t,e,i){if(t=t[e],null==t)return null;if(!(t instanceof i))throw new TypeError("'"+e+"' must be an instance of "+i.name+".");return t}function y(t){return t.split("").reduce(function(t,e,i){return t+(i&&0==i%4?" "+e:e)})}function b(t,e){for(var i={},n=0;n<t.length;++n){var r=e?e(t[n]):t[n].toString();i[r]=t[n]}var s,n=[];for(s in i)n.push(i[s]);return n}function v(t){return String.fromCharCode.apply(null,t)}function g(t){for(var e=new Uint8Array(t.length),i=0;i<t.length;++i)e[i]=t.charCodeAt(i);return e}function m(e,i){var n=void 0==i?!0:i,r=t.btoa(v(e)).replace(/\+/g,"-").replace(/\//g,"_");return n?r:r.replace(/=*$/,"")}function w(e){return g(t.atob(e.replace(/-/g,"+").replace(/_/g,"/")))}function T(t){for(var e="",i=0;i<t.length;++i){var n=t[i].toString(16);1==n.length&&(n="0"+n),e+=n}return e}function E(t,e){if(!t&&!e)return!0;if(!t||!e||t.length!=e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!=e[i])return!1;return!0}function k(t){this.b=t,this.a=new Y(t),Rr||(Rr=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}function P(t){var e;if(e=S(t),7<e.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var i=0,n=0;n<e.length;n++)i=256*i+e[n];e=i,i=S(t);t:{for(n=0;n<Rr.length;n++)if(E(i,Rr[n])){n=!0;break t}n=!1}if(n)throw new RangeError("EbmlParser: Element cannot contain dynamically sized data.");if(8==i.length&&224&i[1])throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var n=i[0]&(1<<8-i.length)-1,r=1;r<i.length;r++)n=256*n+i[r];return i=n,i=t.a.a+i<=t.b.byteLength?i:t.b.byteLength-t.a.a,n=new DataView(t.b.buffer,t.b.byteOffset+t.a.a,i),Z(t.a,i),new j(e,n)}function S(t){var e,i=$(t.a);for(e=1;8>=e&&!(i&1<<8-e);e++);if(e>8)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var n=new Uint8Array(e);for(n[0]=i,i=1;e>i;i++)n[i]=$(t.a);return n}function j(t,e){this.id=t,this.a=e}function A(t){if(8<t.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==t.a.byteLength&&224&t.a.getUint8(0))throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var e=0,i=0;i<t.a.byteLength;i++)var n=t.a.getUint8(i),e=256*e+n;return e}function I(){this.a={}}function _(t){var e,i=[];for(e in t.a)i.push.apply(i,t.a[e]);return i}function R(t,e,i){if(t=t.a[e])for(e=0;e<t.length;++e)t[e]==i&&(t.splice(e,1),--e)}function N(t){var e,i=[];for(e in t.a)i.push(e);return i}function M(){return Date.now()+Nr}function x(){}function C(){this.j=this.a="",this.l=!1,this.i=this.h=null,this.o=this.g=!1,this.v=this.f="",this.c=null,this.b=[]}function D(t){var e=new C;if(!t)return e;var i=f(t,"keySystem");if(null==i)throw Error("'keySystem' cannot be null.");e.a=i;var n=f(t,"licenseServerUrl");if(null!=n)e.j=n;else if(i)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");if(i=p(t,"withCredentials","boolean"),null!=i&&(e.l=i),i=d(t,"licensePostProcessor",Function),null!=i&&(e.h=i),i=d(t,"licensePreProcessor",Function),null!=i&&(e.i=i),i=p(t,"distinctiveIdentifierRequired","boolean"),null!=i&&(e.g=i),i=p(t,"persistentStateRequired","boolean"),null!=i&&(e.o=i),i=f(t,"audioRobustness"),null!=i&&(e.f=i),i=f(t,"videoRobustness"),null!=i&&(e.v=i),i=d(t,"serverCertificate",Uint8Array),null!=i&&(e.c=i),i=d(t,"initData",Object)){if(t=d(i,"initData",Uint8Array),null==t)throw Error("'initData.initData' cannot be null.");if(i=f(i,"initDataType"),null==i)throw Error("'initData.initDataType' cannot be null.");e.b.push({initData:new Uint8Array(t.buffer),initDataType:i})}return e}function O(t,e){var i=t.b.concat(e.map(function(t){return{initData:new Uint8Array(t.initData.buffer),initDataType:t.initDataType}}));t.b=b(i,function(t){return Array.prototype.join.apply(t.initData)+","+t.initDataType})}function U(t,e,i,n,r,s,a,o,h,u,l){this.g=t,this.j=e,this.o=i,this.a=[],this.h=r||null,this.i=s||null,this.f=a==Mr,this.v=o==xr,this.c=h||"",this.l=u||"",this.b=l||null,n&&this.a.push(n)}function L(t){this.c=Math.exp(Math.log(.5)/t),this.a=this.b=0}function B(t){return t.b/(1-Math.pow(t.c,t.a))}function q(t){var e,i=new CustomEvent(t.type,{detail:t.detail,bubbles:!!t.bubbles});for(e in t)e in i||(i[e]=t[e]);return i}function F(t){return new CustomEvent("error",{detail:t,bubbles:!0})}function V(t,e,i){return K(e),K(i),i==e||t>=Cr&&i==e.split("-")[0]||t>=Dr&&i.split("-")[0]==e.split("-")[0]?!0:!1}function K(t){t=t.toLowerCase().split("-");var e=Or[t[0]];return e&&(t[0]=e),t.join("-")}function z(t){this.xa=new I,this.v=t}function H(t,e){e.currentTarget=t;for(var i=t.xa.get(e.type)||[],n=0;n<i.length;++n){var r=i[n];try{r.handleEvent?r.handleEvent(e):r.call(t,e)}catch(s){}}return t.v&&e.bubbles&&H(t.v,e),e.defaultPrevented}function G(){z.call(this,null),this.a=new L(3),this.c=new L(10),this.b=0}function Y(t){var e=Ur;this.b=t,this.c=e==Lr,this.a=0}function J(t){return t.a<t.b.byteLength}function $(t){var e=t.b.getUint8(t.a);return t.a+=1,e}function W(t){var e=t.b.getUint32(t.a,t.c);return t.a+=4,e}function X(t){var e,i;if(t.c?(e=t.b.getUint32(t.a,!0),i=t.b.getUint32(t.a+4,!0)):(i=t.b.getUint32(t.a,!1),e=t.b.getUint32(t.a+4,!1)),i>2097151)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");return t.a+=8,i*Math.pow(2,32)+e}function Q(t){if(t.a+16>t.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var e=new Uint8Array(t.b.buffer,t.a,16);return t.a+=16,e}function Z(t,e){if(t.a+e>t.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");t.a+=e}function tt(){this.g=new h,this.f=!1,this.a=null,this.b=[],this.c=null}function et(t,e){if(t.f)throw Error("Cannot append to a running task!");t.b.push(e)}function it(t,e){var i,n=t.b[0](e);n?(i=n[0],t.c=n[1]):(i=Promise.resolve(),t.c=null),i.then(u(t,function(t){this.a?(this.b=[],this.c=null,nt(this)):(this.b.shift(),this.b.length?it(this,t):(this.g.resolve(t),this.c=null))}))["catch"](u(t,function(t){this.b=[],this.c=null,this.a?nt(this):this.g.reject(t)}))}function nt(e){var i=Error("Task aborted.");i.type="aborted",e.g.reject(i),t.setTimeout(function(){this.a.resolve(),this.a=null}.bind(e),5)}function rt(){this.a=new I}function st(t,e,i,n){e=new ot(e,i,n),t.a.push(i,e)}function at(t){for(var e=_(t.a),i=0;i<e.length;++i)e[i].sa();t.a.a={}}function ot(t,e,i){this.target=t,this.type=e,this.a=i,this.target.addEventListener(e,i,!1)}function ht(t,e,i){MediaSource.isTypeSupported(e),e=t.addSourceBuffer(e),this.j=t,this.c=e,this.v=i,this.h=new rt,this.b=[],this.o=0,this.f=this.a=null,this.l=0,st(this.h,this.c,"updateend",this.w.bind(this))}function ut(t,e){for(var i=t.c.buffered,n=0;n<i.length;++n){var r=i.start(n)-Br,s=i.end(n)+Br;if(e>=r&&s>=e)return i.end(n)-e}return 0}function lt(t,e,i,n){if(t.a)return t=Error("Cannot fetch ("+t.i+"): previous operation not complete."),t.type="stream",Promise.reject(t);t.a=new tt,i!=t.c.timestampOffset&&(t.c.timestampOffset=i),n&&et(t.a,function(){return[yt(this,n),this.g.bind(this)]}.bind(t)),et(t.a,function(){var t=e.a?e.a-e.b:1,i=new ve;return i.a=3,i.h=1e3*t,i.c=1e3*this.l,[Se(e.url,i,this.v),ke.prototype.g.bind(e.url)]}.bind(t)),et(t.a,u(t,function(t){return this.v.getBandwidth(),[yt(this,t),this.g.bind(this)]}));var r=0==t.c.buffered.length&&0==t.b.length,s=null;return et(t.a,function(){if(0==this.c.buffered.length){var t=Error("Failed to buffer segment ("+this.i+").");return t.type="stream",[Promise.reject(t)]}r&&(t=e.b,s=this.c.buffered.start(0)-t),t=Re(this.b,e.b),t>=0?this.b.splice(t+1,0,e):this.b.push(e)}.bind(t)),dt(t).then(function(){return Promise.resolve(s)}.bind(t))}function ct(t){return t.a?(t=Error("Cannot clear ("+t.i+"): previous operation not complete."),t.type="stream",Promise.reject(t)):(t.a=new tt,et(t.a,function(){var t;t:if(0==this.c.buffered.length)t=Promise.resolve();else{try{this.c.remove(0,Number.POSITIVE_INFINITY)}catch(e){t=Promise.reject(e);break t}this.b=[],t=this.f=new h}return[t,this.g.bind(this)]}.bind(t)),dt(t))}function ft(t,e){if(t.a){var i=Error("Cannot clearAfter ("+t.i+"): previous operation not complete.");return i.type="stream",Promise.reject(i)}return t.a=new tt,et(t.a,function(){return[bt(this,e),this.g.bind(this)]}.bind(t)),dt(t)}function pt(t){return t.a?(t=t.a,t.a?t=t.a:t.f?(t.c&&t.c(),t.a=new h,t=t.a):(t.f=!0,t=Promise.resolve())):t=Promise.resolve(),t}function dt(t){return t.a.start(),t.a.g.then(u(t,function(){this.a=null}))["catch"](u(t,function(t){return this.a=null,Promise.reject(t)}))}function yt(t,e){try{t.c.appendBuffer(e)}catch(i){return Promise.reject(i)}return t.f=new h,t.f}function bt(t,e){if(0==t.c.buffered.length)return Promise.resolve();var i=Re(t.b,e);if(-1==i||i==t.b.length-1)return Promise.resolve();try{t.c.remove(t.b[i+1].b,Number.POSITIVE_INFINITY)}catch(n){return Promise.reject(n)}return t.b=t.b.slice(0,i+1),t.f=new h,t.f}function vt(t,e){z.call(this,e),this.a=null,this.h=t}function gt(e){if(!t.indexedDB)return e=Error("Persistant storage requires IndexedDB support."),e.type="storage",Promise.reject(e);if(e.a)return e=Error("A database connection is already open."),e.type="storage",Promise.reject(e);var i=new h,n=t.indexedDB.open("content_database",1);return n.onupgradeneeded=u(e,function(t){this.a=t.target.result,wt(this,"group_store",{keyPath:"group_id"}),wt(this,"stream_index_store",{keyPath:"stream_id"}),t=wt(this,"content_store",{autoIncrement:"true"}),t.createIndex("segment",["stream_id","segment_id"],{unique:!0}),t.createIndex("stream","stream_id",{unique:!1})}),n.onsuccess=u(e,function(t){this.a=t.target.result,i.resolve()}),n.onerror=function(){i.reject(n.error)},i}function mt(t){t.a&&(t.a.close(),t.a=null)}function wt(t,e,i){return t.a.objectStoreNames.contains(e)&&t.a.deleteObjectStore(e),t.a.createObjectStore(e,i)}function Tt(t){return Pt(t,"content_store")}function Et(t){return Pt(t,"stream_index_store")}function kt(t){return Pt(t,"group_store")}function Pt(t,e){return t.a.transaction([e],t.h).objectStore(e)}function St(t,e){var i=new h,n=t.get(e);return n.onerror=function(){i.reject(n.error)},n.onsuccess=function(){if(n.result)i.resolve(n.result);else{var t=Error("Item not found.");t.type="storage",i.reject(t)}},i}function jt(){vt.call(this,"readonly",null)}function At(t){var e=new h,i=[],n=kt(t).openCursor();return n.onerror=function(){e.reject(n.error)},n.onsuccess=function(t){(t=t.target.result)?(i.push(t.key),t["continue"]()):e.resolve(i)},e}function It(t,e){return St(kt(t),e).then(u(t,function(t){return t.session_ids=b(t.session_ids),t.hasOwnProperty("duration")||t.hasOwnProperty("key_system")?Promise.resolve(t):_t(this,t.stream_ids[0]).then(function(e){return t.duration=e.duration,t.key_system=e.key_system,t.license_server=e.license_server,t.with_credentials=e.with_credentials,t.distinctive_identifier=e.distinctive_identifier,t.audio_robustness=e.audio_robustness,t.video_robustness=e.video_robustness,Promise.resolve(t)})}))}function _t(t,e){return St(Et(t),e)}function Rt(t,e,i){return St(Tt(t).index("segment"),[e,i]).then(function(t){return Promise.resolve(t.content)})}function Nt(t){var e=console[t];e?e.bind||(console[t]=function(){e.apply(console,arguments)}):console[t]=function(){}}function Mt(){this.fontSize="100%",this.fontColor=qr,this.fontOpacity=Vr,this.backgroundColor=Fr,this.backgroundOpacity=Vr,this.fontEdge=Kr}function xt(t){var e=[];e.push("font-size: "+t.fontSize),e.push("color: "+Ct(t.fontColor,t.fontOpacity)),e.push("background-color: "+Ct(t.backgroundColor,t.backgroundOpacity));for(var i=[],n=0;n<t.fontEdge.length;++n){var r=t.fontEdge[n].slice(3,6);i.push(Ct(t.fontEdge[n].slice(0,3),t.fontOpacity)+" "+r.join("px ")+"px")}return e.push("text-shadow: "+i.join(",")),e.join("; ")}function Ct(t,e){return"rgba("+t.concat(e).join(",")+")"}function Dt(t){this.systemIds=[],this.cencKeyIds=[],t=new Y(new DataView(t.buffer));try{for(;J(t);){var e=t.a,i=W(t),n=W(t);if(1==i?i=X(t):0==i&&(i=t.b.byteLength-e),1886614376!=n)Z(t,i-(t.a-e));else{var r=$(t);if(r>1)Z(t,i-(t.a-e));else{Z(t,3);var s=T(Q(t)),a=[];if(r>0)for(var o=W(t),h=0;o>h;++h){var u=T(Q(t));a.push(u)}var l=W(t);Z(t,l),this.cencKeyIds.push.apply(this.cencKeyIds,a),this.systemIds.push(s),t.a!=e+i&&Z(t,i-(t.a-e))}}}}catch(c){}}function Ot(t){Hr[t]={na:zr(),end:NaN}}function Ut(t){(t=Hr[t])&&(t.end=zr())}function Lt(t){return(t=Hr[t])&&t.end?t.end-t.na:NaN}function Bt(){var e="CustomEvent"in t;if(e)try{new CustomEvent("")}catch(i){e=!1}e||(t.CustomEvent=qt)}function qt(t,e){var i=document.createEvent("CustomEvent"),n=e||{bubbles:!1,cancelable:!1,detail:null};return i.initCustomEvent(t,!!n.bubbles,!!n.cancelable,n.detail),i}function Ft(){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in t&&(t.getVideoPlaybackQuality=Vt)}function Vt(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function Kt(){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,t=Document.prototype,t.exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitExitFullscreen,"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}}),document.addEventListener("webkitfullscreenchange",zt),document.addEventListener("webkitfullscreenerror",zt),document.addEventListener("mozfullscreenchange",zt),document.addEventListener("mozfullscreenerror",zt),document.addEventListener("MSFullscreenChange",zt),document.addEventListener("MSFullscreenError",zt)}function zt(t){var e=t.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),e=new Event(e,t);t.target.dispatchEvent(e)}function Ht(){return Promise.reject(Error("The key system specified is not supported."))}function Gt(t){return null==t?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Yt(){throw new TypeError("Illegal constructor.")}function Jt(){throw new TypeError("Illegal constructor.")}function $t(t,e){try{var i=new Xt(t,e);return Promise.resolve(i)}catch(n){return Promise.reject(n)}}function Wt(t){var e=this.mediaKeys;return e&&e!=t&&Zt(e,null),delete this.mediaKeys,(this.mediaKeys=t)&&Zt(t,this),Promise.resolve()}function Xt(t,e){this.a=this.keySystem=t;var i=!0;"org.w3.clearkey"==t&&(this.a="webkit-org.w3.clearkey",i=!1);var n,r=!1;n=document.getElementsByTagName("video"),n=n.length?n[0]:document.createElement("video");for(var s=0;s<e.length;++s){var a=e[s],o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:a.initDataTypes,sessionTypes:["temporary"]},h=!1;if(a.audioCapabilities)for(var u=0;u<a.audioCapabilities.length;++u){var l=a.audioCapabilities[u];l.contentType&&(h=!0,n.canPlayType(l.contentType.split(";")[0],this.a)&&(o.audioCapabilities.push(l),r=!0))}if(a.videoCapabilities)for(u=0;u<a.videoCapabilities.length;++u)l=a.videoCapabilities[u],l.contentType&&(h=!0,n.canPlayType(l.contentType,this.a)&&(o.videoCapabilities.push(l),r=!0));if(h||(r=n.canPlayType("video/mp4",this.a)||n.canPlayType("video/webm",this.a)),"required"==a.persistentState&&(i?(o.persistentState="required",o.sessionTypes=["persistent-license"]):r=!1),r)return void(this.b=o)}throw Error("None of the requested configurations were supported.")}function Qt(t){this.g=t,this.b=null,this.a=new rt,this.c=[],this.f={}}function Zt(t,e){t.b=e,at(t.a),e&&(st(t.a,e,"webkitneedkey",t.Bb.bind(t)),st(t.a,e,"webkitkeymessage",t.Ab.bind(t)),st(t.a,e,"webkitkeyadded",t.yb.bind(t)),st(t.a,e,"webkitkeyerror",t.zb.bind(t)))}function te(t,e){var i=t.f[e];return i?i:(i=t.c.shift())?(i.sessionId=e,t.f[e]=i):null}function ee(t,e,i){z.call(this,null),this.f=t,this.h=!1,this.a=this.b=null,this.c=e,this.g=i,this.sessionId="",this.expiration=NaN,this.closed=new h,this.keyStatuses=new se}function ie(t,e,i){if(t.h)return Promise.reject(Error("The session is already initialized."));t.h=!0;var n;try{if("persistent-license"==t.g)if(i)n=g("LOAD_SESSION|"+i);else{var r=new Uint8Array(e);n=g("PERSISTENT|"+v(r))}else n=new Uint8Array(e)}catch(s){return Promise.reject(s)}t.b=new h;try{t.f.webkitGenerateKeyRequest(t.c,n)}catch(a){if("InvalidStateError"!=a.name)return t.b=null,Promise.reject(a);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,n)}catch(t){this.b.reject(t),this.b=null}}.bind(t),10)}return t.b}function ne(t,e){var i=t.keyStatuses;i.size=void 0==e?0:1,i.a=e,i=q({type:"keystatuseschange"}),t.dispatchEvent(i)}function re(t){this.b=t,this.a=0}function se(){this.size=0,this.a=void 0}function ae(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(Gr=new Uint8Array([0]),Navigator.prototype.requestMediaKeySystemAccess=$t,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Wt,t.MediaKeys=Qt,t.MediaKeySystemAccess=Xt):(Navigator.prototype.requestMediaKeySystemAccess=Ht,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Gt,t.MediaKeys=Yt,t.MediaKeySystemAccess=Jt))}function oe(t){var e;t instanceof oe?(he(this,t.R),this.aa=t.aa,this.P=t.P,ue(this,t.fa),this.N=t.N,le(this,t.a.clone()),this.$=t.$):t&&(e=String(t).match(Yr))?(he(this,e[1]||"",!0),this.aa=ce(e[2]||""),this.P=ce(e[3]||"",!0),ue(this,e[4]),this.N=ce(e[5]||"",!0),le(this,e[6]||"",!0),this.$=ce(e[7]||"")):this.a=new de(null)}function he(t,e,i){t.R=i?ce(e,!0):e,t.R&&(t.R=t.R.replace(/:$/,""))}function ue(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.fa=e}else t.fa=null}function le(t,e,i){e instanceof de?t.a=e:(i||(e=fe(e,Xr)),t.a=new de(e))}function ce(t,e){return t?e?decodeURI(t):decodeURIComponent(t):""}function fe(t,e,i){return"string"==typeof t?(t=encodeURI(t).replace(e,pe),i&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function pe(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)}function de(t){this.b=t||null}function ye(t,e,i){if(!t.a&&(t.a={},t.c=0,t.b))for(var n=t.b.split("&"),r=0;r<n.length;r++){var s=n[r].indexOf("="),a=null,o=null;s>=0?(a=n[r].substring(0,s),o=n[r].substring(s+1)):a=n[r],a=decodeURIComponent(a.replace(/\+/g," ")),o=o||"",ye(t,a,decodeURIComponent(o.replace(/\+/g," ")))}t.b=null,(n=t.a.hasOwnProperty(e)&&t.a[e])||(t.a[e]=n=[]),n.push(i),t.c++}function be(t,e){this.url=t,this.b=e||new ve,this.g=this.i=this.h=0,this.a=null,this.c=new h,this.f=null}function ve(){this.body=null,this.a=1,this.h=1e3,this.c=0,this.method="GET",this.f="arraybuffer",this.b={},this.g=this.i=!1}function ge(t){me(t),t.b.body=null,t.c.destroy(),t.c=null,t.f=null}function me(t){t.a&&(t.a.onload=null,t.a.onreadystatechange=null,t.a.onerror=null,t.a.ontimeout=null),t.a=null}function we(t){var e=t.url.split("/"),i=parseInt(e[2],10),n=parseInt(e[3],10),r=new jt;return gt(r).then(function(){return Rt(r,i,n)}).then(u(t,function(t){var e=JSON.parse(JSON.stringify(new XMLHttpRequest));return e.response=t,t=this.c,t.resolve(e),mt(r),ge(this),t}))["catch"](u(t,function(t){return mt(r),ge(this),Promise.reject(t)}))}function Te(t,e,i){return e=Error(e),e.type=i,e.status=t.a.status,e.url=t.url,e.method=t.b.method,e.body=t.b.body,e.Lb=t.a,e}function Ee(e){me(e),t.setTimeout(e.bb.bind(e),e.g*(1+.5*(2*Math.random()-1))),e.g*=2}function ke(t,e,i,n){this.c=e,this.f=i||0,this.h=null!=n?n:null,this.b=this.a=null,this.i=t}function Pe(t,e){return t&&0!==t.length?t.map(function(t){return t.resolve(e)}):[e]}function Se(t,e,i){return t.a?t.a:(e=e||new ve,(t.f||t.h)&&(e.b.Range="bytes="+(t.f+"-"+(null!=t.h?t.h:""))),t.a=je(t,0,e,i),t.a)}function je(t,e,i,n){var r=t.c[e].toString();return t.i&&(r=t.i(r,i.b)||r),t.b=new be(r,i),n&&(t.b.f=n),r=t.b.bb().then(u(t,function(t){return this.b=this.a=null,Promise.resolve(t.response)})),r=r["catch"](u(t,function(t){return this.a&&e+1<this.c.length?this.a=je(this,e+1,i,n):(this.a=this.b=null,Promise.reject(t))}))}function Ae(t){this.a=t}function Ie(t,e,i){this.b=t,this.a=e,this.url=i}function _e(t,e,i){return new Ie(e,i,t.url)}function Re(t,e){for(var i=t.length-1;i>=0;--i){var n=t[i];if(e>=n.b&&(null==n.a||e<n.a))return i}return-1}function Ne(t,e){return t.map(function(t){return _e(t,t.b+e,null!=t.a?t.a+e:null)})}function Me(){}function xe(){}function Ce(t){this.u=t,this.g=0}function De(t){if(0==t.u.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return t.u[0]}function Oe(t){if(0==t.u.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return t.u[t.u.length-1]}function Ue(t,e){if(t.g!=e.g&&(e=new Ce(Ne(e.u,t.g-e.g))),0==t.length())t.u=e.u.slice(0);else if(0!=e.length()&&null!=Oe(t).a&&!(null!=Oe(e).a&&Oe(e).a<Oe(t).a)){if(Oe(t).a<=De(e).b)var i=_e(Oe(t),Oe(t).b,De(e).b),i=t.u.slice(0,-1).concat([i]);else{var n;for(n=0;n<t.u.length&&!(t.u[n].a>=De(e).b);++n);t.u[n].b<De(e).b?(i=_e(t.u[n],t.u[n].b,De(e).b),i=t.u.slice(0,n).concat([i])):(De(t).b>De(e).b||De(e),i=t.u.slice(0,n))}t.u=i.concat(e.u)}}function Le(t){this.b=t,this.a=null}function Be(t){this.b=t,this.a=null}function qe(){this.A=Zr++,this.id=this.C=this.F=null,this.c=0,this.height=this.width=this.bandwidth=null,this.b=this.a="",this.f=[],this.L=!1,this.J=!0}function Fe(t){var e=t.a||"";return t.b&&(e+='; codecs="'+t.b+'"'),e}function Ve(){this.A=ts++,this.id=null,this.contentType=this.lang="",this.b=!1,this.m=[],this.a=[]}function Ke(t){for(var e=[],i=0;i<t.a.length;++i){var n=new Ge;n.id=t.A,n.a=t.a[i],n.contentType=t.contentType,n.b=t.m.length?Fe(t.m[0]):"",e.push(n)}return e}function ze(){this.id=null,this.start=0,this.b=null,this.a=[]}function He(){this.b=!1,this.g=this.f=null,this.c=0,this.a=[]}function Ge(){this.id=0,this.a=null,this.b=this.contentType=""}function Ye(t,e){z.call(this,t),this.b=e,this.h=!0,this.g=this.f=null,this.c=new h,this.a=null}function Je(t,e,i,n,r){z.call(this,t),this.c=e,this.a=new ht(i,n,r),this.B=this.D=this.b=null,this.I=!1,this.g=null,this.l=!1,this.i=null,this.o=!1,this.h=new h,this.j=this.f=!1,this.K=0,this.w=15,this.G=!1}function $e(t,e,i){t.b&&!t.l&&(t.l=!0,ei(t),pt(t.a).then(u(t,function(){var t=this.c.currentTime;return!e&&0<ut(this.a,t)&&0<=Re(this.a.b,t)?Promise.resolve():i?ft(this.a,this.c.currentTime+i):(this.G=!0,ct(this.a))})).then(u(t,function(){this.l=!1,ti(this,0)}))["catch"](u(t,function(t){this.l=!1,this.f?(t=F(t),this.dispatchEvent(t)):this.h.reject(t)})))}function We(t,e,i){t=t.a;var n=t.b.length;return t=n>0?t.b[n-1]:null,null!=t?null!=t.a?i.ia(t.a):null:i.ia(e)||(i.length()?Oe(i):null)}function Xe(t){if(!t.o&&null!=t.i){t.o=!0;var e=t.a,i=t.i,n=i-e.o;0!=n&&(e.b=Ne(e.b,n),e.o=i),t.h.resolve(t.i)}}function Qe(t,e){var i;i=e.a.split("/")[0],i=q({type:"adaptation",bubbles:!0,contentType:i,size:"video"!=i?null:{width:e.width,height:e.height},bandwidth:e.bandwidth}),t.dispatchEvent(i)}function Ze(t){var e=q({type:"ended"});t.dispatchEvent(e)}function ti(e,i){e.g=t.setTimeout(e.xb.bind(e),i)}function ei(e){null!=e.g&&(t.clearTimeout(e.g),e.g=null)}function ii(){this.streamStats=null,this.droppedFrames=this.decodedFrames=NaN,this.bufferingTime=this.playTime=this.estimatedBandwidth=0,this.playbackLatency=NaN,this.bufferingHistory=[],this.bandwidthHistory=[],this.streamHistory=[]}function ni(t,e){var i=new ri(e);t.streamHistory.push(new si(i)),(i.videoHeight||!t.streamStats)&&(t.streamStats=i)}function ri(t){this.videoWidth=t.width,this.videoHeight=t.height,this.videoMimeType=t.a,this.videoBandwidth=t.bandwidth}function si(t){this.timestamp=M()/1e3,this.value=t}function ai(t,e,i,n,r,s){this.b=new ke(null,[new oe(t)]),this.a=new ve,this.a.body=e,this.a.method=i,this.a.a=3,this.a.i=n,this.a.c=1e3*(null!=s?s:0),t=r||{};for(var a in t)this.a.b[a]=t[a]}function oi(t){return Se(t.b,t.a).then(function(t){return Promise.resolve(new Uint8Array(t))})}function hi(t,e,i){z.call(this,t),this.g=e,this.b=i,this.a=this.h=null,this.l=new rt,this.j={},this.f=[],this.o=0,this.c=new h,this.i=null,this.w=0}function ui(e,i){return null==e.i&&(e.i=t.setTimeout(function(){var t=Error("Timeout waiting for sessions.");t.type="storage",this.c.reject(t)}.bind(e),i)),e.c}function li(t){return Promise.all(t.f.map(function(t){return t.remove()}))}function ci(t,e,i){for(var n in e)i=i["catch"](function(t,e){return navigator.requestMediaKeySystemAccess(t,[e])}.bind(null,n,e[n]));return t.b.ea()&&(i=i["catch"](function(){throw Error("Either none of the requested key systems are supported or none of the requested key systems support persistent state.");
})),i}function fi(){var t=Error("EmeManager destroyed");return t.type="destroy",Promise.reject(t)}function pi(t){for(var e=t.b.va(),i=0;i<e.length;++i){var n=di(t),r=n.load(e[i]);t.f.push(n),r.then(u(t,function(){this.o++,this.o>=this.f.length&&this.c.resolve()}))["catch"](u(t,function(t){t=F(t),this.dispatchEvent(t)}))}}function di(t){var e=null;if(t.b.ea())try{e=t.h.createSession("persistent-license")}catch(i){throw Error("Persistent licenses are not supported by this key system or platform.")}else e=t.h.createSession();return st(t.l,e,"message",t.sb.bind(t)),st(t.l,e,"keystatuseschange",t.kb.bind(t)),e}function yi(t,e,i,n){n=bi(i,n),oi(new ai(n.url,n.body,n.method,i.l,n.headers,t.w)).then(u(t,function(t){return i.h&&(t=i.h(t)),e.update(t)})).then(u(t,function(){var t=q({type:"sessionReady",detail:e});this.dispatchEvent(t),this.o++,this.o>=this.f.length&&this.c.resolve()}))["catch"](u(t,function(t){t.Nb=e,t=F(t),this.dispatchEvent(t)}))}function bi(t,e){var i={url:t.j,body:e.slice(0),method:"POST",headers:{}};if(!t.i)return i;if(t.i(i),i.url=f(i,"url"),null==i.url)throw Error("'url' cannot be null.");if(!(i.body instanceof ArrayBuffer||"string"==typeof i.body||null==i.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");if(i.method=f(i,"method"),"GET"!=i.method&&"POST"!=i.method)throw Error("'method' must be either 'GET' or 'POST'.");if(i.headers=d(i,"headers",Object),null==i.headers)throw Error("'headers' cannot be null.");return i}function vi(t){z.call(this,null),this.a=t,this.b=null,this.f=new rt,this.j=this.l=null,this.H=0,this.B=null,this.i=!1,this.g=new ii,this.c={enableAdaptation:!0,streamBufferSize:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new r},this.o=1,this.D=null}function gi(e){return"text/vtt"==e?!!t.VTTCue:MediaSource.isTypeSupported(e)}function mi(){var t=Error("Player destroyed");return t.type="destroy",Promise.reject(t)}function wi(e){e.j&&(t.clearTimeout(e.j),e.j=null)}function Ti(e){Ei(e),e.B=t.setTimeout(e.Y.bind(e),100)}function Ei(e){e.B&&(t.clearTimeout(e.B),e.B=null)}function ki(t){Ut("buffering");var e=t.g;e.bufferingTime+=Lt("buffering")/1e3,t.i=!1,t.dispatchEvent(q({type:"bufferingEnd"}))}function Pi(t){for(var e=0;e<t.length;++e)for(var i=t[e],n=0;n<i.a.length;++n){for(var r=i.a[n],s=r,a=0;a<s.m.length;++a)gi(Fe(s.m[a]))||(s.m.splice(a,1),--a);0==r.m.length&&(i.a.splice(n,1),--n)}}function Si(t){for(var e=0;e<t.length;++e)for(var i=t[e],n=0;n<i.a.length;++n)i.a[n].m.sort(ji)}function ji(t,e){var i=t.bandwidth||Number.MAX_VALUE,n=e.bandwidth||Number.MAX_VALUE;return n>i?-1:i>n?1:0}function Ai(t){this.a=t}function Ii(t,e){var i=_i(e),n=_i(t.a);return Promise.all([i,n]).then(u(t,function(t){var i=t[0];t=t[1];var n=this.a.a;return Pi(n),Si(n),e.f=this.a.f,e.g=this.a.g?this.a.g.clone():null,e.c=this.a.c,n=[],Ri(e,this.a,i,t,n),i=e.a,Pi(i),Si(i),Promise.resolve(n)}))}function _i(t){function e(t,e){return t.concat(e)}var i=t.a.map(function(t){return t.a}).reduce(e,[]).map(function(t){return t.m}).reduce(e,[]);return t=i.map(function(t){return t.F.create()}),Promise.all(t).then(function(t){for(var e={},n=0;n<i.length;++n)e[i[n].A]=t[n];return Promise.resolve(e)})}function Ri(t,e,i,n,r){var s=new I;t.a.forEach(function(t,e){s.push(t.id||""+e,t)});var a=new I;for(e.a.forEach(function(t,e){a.push(t.id||""+e,t)}),t=N(s),e=0;e<t.length;++e){var o=t[e],h=s.get(o);1<h.length||(o=a.get(o))&&0!=o.length&&1==o.length&&(Ni(h[0],o[0],i,n,r),h[0].b=o[0].b)}}function Ni(t,e,i,n,r){var s=new I;t.a.forEach(function(t,e){s.push(t.id||""+e,t)});var a=new I;for(e.a.forEach(function(t,e){a.push(t.id||""+e,t)}),t=N(s),e=0;e<t.length;++e){var o=t[e],h=s.get(o);1<h.length||(o=a.get(o))&&0!=o.length&&1==o.length&&Mi(h[0],o[0],i,n,r)}}function Mi(t,e,i,n,r){var s=new I;t.m.forEach(function(t,e){s.push(t.id||""+e,t)});var a=new I;e.m.forEach(function(t,e){a.push(t.id||""+e,t)}),e={};for(var o=N(s),h=0;h<o.length;++h){var u=o[h];e[u]=u;var l=s.get(u);1<l.length||((u=a.get(u))&&0!=u.length?1==u.length&&(xi(l[0],u[0],i,n),l[0].C=u[0].C,u[0].C=null,l[0].c=u[0].c):(r.push(l[0]),t.m.splice(t.m.indexOf(l[0]),1)))}for(o=N(a),h=0;h<o.length;++h)u=o[h],e[u]||(e[u]=u,u=a.get(u),t.m.push(u[0]))}function xi(t,e,i,n){t=i[t.A],e=n[e.A],t.length(),t.Ca(e)&&t.length()}function Ci(){this.a=this.b=null,this.f=new rt,this.c=Number.POSITIVE_INFINITY,this.i=!0,this.g=!1}function Di(t){var e=t.a.ja();if(0==e.length)return null;e.sort(a);var i;t:{i=t.a.pa();for(var n=0;n<i.length;++n)if(i[n].active){i=i[n];break t}i=null}i=i?i.bandwidth:0,t=t.b.getBandwidth();for(var n=e[0],r=0;r<e.length;++r){var s=e[r],o=r+1<e.length?e[r+1]:{bandwidth:Number.POSITIVE_INFINITY};if(s.bandwidth&&(o=(o.bandwidth+i)/.85,t>=(s.bandwidth+i)/.95&&o>=t&&(n=s,n.active)))break}return n}function Oi(t,e,i){z.call(this,null),this.f=t,this.c=e,this.b=D(i),this.a=null}function Ui(t,e,i){z.call(this,null),this.a=t,this.X=e,this.i=new rt,this.g=new MediaSource,this.f=null,this.ba=0,this.b=new I,this.G=i,this.G.initialize(e,this),this.D=!1,this.H="en",this.da=!1,this.K=null,this.w=new h,this.h=new r,this.B=null,this.ua=1,this.c={},this.ca=new h,this.V=0,this.ta=!1,this.o={},this.Y=this.W=this.Z=null,this.S={}}function Li(t,e){var i=e.a.split("/")[0],n=t.c[i];if(n&&n.oa()==e){var r=t.b.get(e.a.split("/")[0]),s=r.map(function(t){return t.m}).reduce(function(t,e){return t.concat(e)},[]).filter(function(t){return t.L&&t.J});if(0==s.length)return void r.push(e);t.o[i].Ia==e&&delete t.o[i],n.ra(s[0],!0),e.destroy()}e.destroy()}function Bi(t){if(t.h){for(var e=!1,i=0;i<t.a.a.length;++i)for(var n=t.a.a[i],r=0;r<n.a.length;++r){var s=n.a[r];if("video"==s.contentType)for(var a=0;a<s.m.length;++a){var o=s.m[a],h=o.J;o.J=!0,t.h.maxWidth&&o.width>t.h.maxWidth&&(o.J=!1),t.h.maxHeight&&o.height>t.h.maxHeight&&(o.J=!1),t.h.maxBandwidth&&o.bandwidth>t.h.maxBandwidth&&(o.J=!1),t.h.minBandwidth&&o.bandwidth<t.h.minBandwidth&&(o.J=!1),h!=o.J&&(e=!0)}}0!=_(t.b).length&&e&&(qi(t),0<t.ja().length||(e=Error("The application has restricted all video tracks!"),e.type="app",e=F(e),t.dispatchEvent(e)))}}function qi(t){var e=q({type:"trackschanged",bubbles:!0});t.dispatchEvent(e)}function Fi(t,e,i,n,r){if(!t.b.a.hasOwnProperty(e)||!t.c[e])return!1;for(var s=t.b.get(e),a=0;a<s.length;++a)for(var o=s[a],h=0;h<o.m.length;++h){var u=o.m[h];if(u.A==i)return u.L&&u.J?"text"==e||t.ta?(ni(t.K,u),t.c[e].ra(u,n,r),!0):(i=t.o[e],t.o[e]={Ia:u,La:null!=i&&i.La||n,Ma:null!=i&&i.Ma||r},!0):!1}return!1}function Vi(t,e){for(var i=0;2>=i;++i)for(var n=0;n<e.length;++n){var r=e[n];if(V(i,t.H,r.lang))return e.splice(n,1),void e.splice(0,0,r)}for(n=0;n<e.length;++n)if(r=e[n],r.b){e.splice(n,1),e.splice(0,0,r);break}}function Ki(t){for(var e=[],i=["audio","video","text"],n=0;n<i.length;++n){var r=i[n];t.b.a.hasOwnProperty(r)&&e.push(t.b.get(r)[0])}for(var s=zi(t,e),n=0;n<i.length;++n)if(r=i[n],t.b.a.hasOwnProperty(r)&&!s[r])return t=Error("Unable to select an initial "+r+" stream: all "+r+" streams have been restricted (by the application or by the key system)."),t.type="stream",Promise.reject(t);return e=l(s).map(function(t){return t.F.create()}),Promise.all(e).then(u(t,function(t){return t.every(function(t){return t.length()})&&(t=Zi(this,t))?Hi(this,s)?(this.G.start(),Yi(this,s,t),Promise.resolve()):(t=Error("Failed to create Stream objects."),t.type="stream",Promise.reject(t)):(t=Error("Some streams are not available."),t.type="stream",Promise.reject(t))}))["catch"](u(t,function(t){return"aborted"!=t.type?(Object.keys(this.c),this.a.b?(tn(this,0),Promise.resolve()):Promise.reject(t)):void 0}))}function zi(t,e){for(var i={},n=0;n<e.length;++n){var r=e[n],s=null;if("video"==r.contentType){var a=t.G.getInitialVideoTrackId();if(null==a)continue;if(s=r.m.filter(function(t){return t.A==a}),0==s.length)continue;s=s[0]}else if("audio"==r.contentType){if(s=r.m.filter(function(t){return t.L&&t.J}),0==s.length)continue;s=r.m[Math.floor(s.length/2)]}else 0<r.m.length&&(s=r.m[0]);i[r.contentType]=s}return i}function Hi(t,e){var i,n={};for(i in e){var r=e[i],r="text"==i?new Ye(t,t.f):Gi(t,r);if(!r)return l(n).forEach(function(t){t.destroy()}),!1;n[i]=r}return t.c=n,!0}function Gi(t,e){var i=new Je(t,t.f,t.g,Fe(e),t.X);return i.H(t.S),i}function Yi(t,e,i){t.ua=t.f.playbackRate,t.f.playbackRate=0,$i(t,i);var n;n=t.a.b?i.end:t.Y&&t.Y<=i.end&&t.Y>=i.start?t.Y:i.start,st(t.i,t.f,"seeking",t.rb.bind(t)),t.f.currentTime!=n&&(t.f.currentTime=n,t.B=n),Wi(t,i.start,i.end),i=[];for(var r in t.c){n=t.c[r],i.push(n.cb(t.ca)),st(t.i,n,"ended",t.tb.bind(t));var s=e[r];ni(t.K,s),n.ra(s,!1)}Promise.all(i).then(t.ib.bind(t))["catch"](u(t,function(t){"destroy"!=t.type&&(t=F(t),this.dispatchEvent(t))})),t.Ga(t.da)}function Ji(t,e,i){(e=Zi(t,e))&&($i(t,e),Wi(t,e.start,e.end)),0!=i?(i=t.f.currentTime+i,t.f.currentTime=i,t.B=i):i=t.f.currentTime,t.a.b&&e&&(t.V=e.end-i,t.V=Math.max(t.V,0)),t.f.playbackRate=t.ua,t.a.b&&null!=t.a.f&&tn(t,t.V),en(t),t.ca.resolve()}function $i(t,e){if(t.a.b)isNaN(t.g.duration)&&(t.g.duration=e.end+2592e3);else if(isNaN(t.g.duration)||e.end>t.g.duration){t.g.duration=e.end;for(var i=0;i<t.g.sourceBuffers.length;++i)t.g.sourceBuffers[i].appendWindowEnd=e.end}}function Wi(t,e,i){e=q({type:"seekrangechanged",bubbles:!0,start:e,end:i}),t.dispatchEvent(e)}function Xi(t,e,i,n){return e>=i-.01?!1:(t.f.currentTime=Math.min(i+(t.a.b?t.a.c:0),n),!0)}function Qi(t){return l(t.c).map(function(t){return t.Pa()}).filter(function(t){return null!=t})}function Zi(t,e){for(var i=0,n=Number.POSITIVE_INFINITY,r=0;r<e.length;++r){var s=e[r].Ba(),i=Math.max(i,s.start);null!=s.end&&(n=Math.min(n,s.end))}if(n==Number.POSITIVE_INFINITY){if(n=t.a.a[0],!n.b)return null;n=(n.start||0)+n.b}return t.a.b&&(n=Math.max(n-(t.a.c+t.V),i)),i>n?null:{start:i,end:n}}function tn(e,i){if(null!=e.a.f){var n=Math.max(e.a.f,3),n=Math.max(n-i,0);e.Z=t.setTimeout(e.vb.bind(e),1e3*n)}}function en(e){e.a.b&&(e.W=t.setTimeout(e.wb.bind(e),1e3))}function nn(t){for(var e in t.c)t.c[e].H(t.S)}function rn(t,e){vt.call(this,"readwrite",e),this.j=t,this.b=0}function sn(t,e,i,n,r){for(var s=[],a=[],o=0,l=0,c=[],f=e.map(function(t){return t.F.create()}),f=Promise.all(f),p=e.map(function(t){return t.C.create()}),p=Promise.all(p),f=Promise.all([f,p]).then(function(t){s=t[0],a=t[1],o=s.reduce(function(t,e){return t+e.length()},0)}),p=0;p<e.length;++p)f=f.then(function(t){return on(this,e[t],s[t],a[t],o,l)}.bind(t,p)),f=f.then(function(t,e){l+=s[t].length(),c.push(e)}.bind(t,p));return f.then(u(t,function(){return hn(kt(this))})).then(u(t,function(t){var e=new h;i=b(i);var s={group_id:t,stream_ids:c,session_ids:i,duration:n,key_system:r.a,license_server:r.j,with_credentials:r.l,distinctive_identifier:r.g,audio_robustness:r.f,video_robustness:r.v},a=kt(this).put(s);return a.onsuccess=function(){e.resolve(t)},a.onerror=function(){e.reject(a.error)},e}))}function an(t,e){return St(kt(t),e).then(u(t,function(t){var i,n=[];for(i in t.stream_ids)n.push(ln(this,t.stream_ids[i]));return t=kt(this),n.push(t["delete"](e)),Promise.all(n)}))}function on(t,e,i,n,r,s){var a=[hn(Et(t)),hn(Tt(t).index("stream"))],a=Promise.all(a).then(u(t,function(t){return{qa:Math.max(t[0],t[1]),ga:new ArrayBuffer(0),Da:0,u:[],za:null,Jb:r,Ua:s}})),a=a.then(t.f.bind(t,i));return a=a.then(t.g.bind(t,e,n))}function hn(t){var e=new h,i=t.openCursor(null,"prev");return i.onsuccess=function(t){t.target.result?e.resolve(t.target.result.key+1):e.resolve(0)},i.onerror=function(){e.reject(i.error)},e}function un(t,e){var i=new Uint8Array(t.byteLength+e.byteLength);return i.set(new Uint8Array(t),0),i.set(new Uint8Array(e),t.byteLength),i.buffer}function ln(t,e){var i=new h,n=Et(t)["delete"](e);n.onerror=function(){i.reject(n.error)};var r=Tt(t);return r.index("stream").openKeyCursor(IDBKeyRange.only(e)).onsuccess=function(t){(t=t.target.result)&&(r["delete"](t.primaryKey),t["continue"]())},r.transaction.oncomplete=function(){i.resolve()},i}function cn(t,e,i,n){Ce.call(this,t),this.f=e,this.o=i,this.v=n,this.c=this.j=this.a=null,fn(this)}function fn(t){if(0!=t.length()){t.length();var e=null!=Oe(t).a?Oe(t).a:Oe(t).b;if(t.f.b>t.v)t.a=e;else{var i=t.v-(t.f.b+t.o.start);0>i?t.a=e:i<Math.max(Oe(t).b,Oe(t).a||0)?(Oe(t),t.a=e):t.a=i}t.j=Oe(t).b,t.c=De(t).b}}function pn(t,e){if(dn(t,e),null==t.a||null==t.j||null==t.c)return{start:0,end:0};var i=e-t.v,n=t.a+i;return null!=t.f.f&&(n=n-t.c-t.f.f,n>0&&(t.c+=n)),i=t.j+i,i=0<t.length()?null!=Oe(t).a?Math.min(i,Oe(t).a):i:t.c,i=Math.max(i,t.c),{start:t.c,end:i}}function dn(t,e){if(null!=t.f.f)if(null==t.a)t.length();else{for(var i=t.a+(e-t.v),n=0,r=0;r<t.u.length;++r){var s=null;if(r<t.u.length-1?s=t.u[r+1].a:(s=t.u[r],s=null!=s.a?s.a+(s.a-s.b):null),!(null!=s&&s<i-t.f.f))break;++n}n>0&&t.u.splice(0,n)}}function yn(t,e,i,n,r,s,a){this.g=t,this.j=e,this.f=i,this.a=n,this.c=r,this.v=s,this.i=this.b=null,this.h=a}function bn(t,e,i,n,r){this.b=t,this.c=e,this.f=i,this.h=n,this.a=null,this.g=r}function vn(){this.id=this.url=null,this.type="static",this.c=this.j=this.s=null,this.h=5,this.f=this.b=this.g=null,this.i=1,this.a=[]}function gn(){this.g=this.f=this.c=this.s=this.a=this.start=this.id=null,this.b=[]}function mn(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.group=this.id=null,this.c=!1,this.h=this.g=this.f=this.s=null,this.j=[],this.a=[]}function wn(){this.value=null}function Tn(){this.contentType=this.lang=this.id=null}function En(){this.a=this.b=this.g=this.s=this.h=this.f=this.height=this.width=this.bandwidth=this.lang=this.id=null,this.c=[]}function kn(){this.value=this.schemeIdUri=this.b=null,this.children=[],this.a=this.pssh=null}function Pn(){this.parsedPssh=this.psshBox=null}function Sn(){this.url=null}function jn(){this.url=null}function An(){this.s=null,this.g=1,this.c=this.b=this.a=this.f=null}function In(){this.a=this.url=null}function _n(){this.a=this.url=null}function Rn(){this.s=null,this.f=1,this.b=this.g=null,this.i=1,this.h=null,this.a=[],this.c=null}function Nn(){this.a=this.b=null}function Mn(){this.b=1,this.a=this.i=null,this.j=1,this.c=this.g=this.f=this.h=null}function xn(){this.a=[]}function Cn(){this.c=this.a=this.b=null}function Dn(t,e){this.na=t,this.end=e}function On(t){for(var e=[],i=0;i<t.b.length;++i){var n=t.b[i];null!=n.group&&(e[n.group]=!0)}for(i=0;i<t.b.length;++i)if(n=t.b[i],null==n.group){for(var r=1;1==e[r];)++r;e[r]=!0,n.group=r}}function Un(t,e){if(!e||0===e.length)return t;for(var i=[],n=0;n<e.length;n++){var r=e[n].url;null==t||0===t.length?i.push(new oe(r)):(r=Ln(t.slice(0,1),r),i.push(r[0]))}return i}function Ln(t,e){if(!e)return t;var i=new oe(e);return t?t.map(function(t){return t.resolve(i)}):[i]}function Bn(t,e,i){var n=Hn(i);return(e=Fn(e,i.constructor.TAG_NAME))&&n.parse(t,e),n}function qn(t,e,i){var n=null;return(e=Fn(e,i.TAG_NAME))&&(n=new i,n.parse(t,e)),n}function Fn(t,e){for(var i=null,n=0;n<t.childNodes.length;n++)if(t.childNodes[n].tagName==e){if(i)return null;i=t.childNodes[n]}return i}function Vn(t,e,i){for(var n=[],r=0;r<e.childNodes.length;r++)if(e.childNodes[r].tagName==i.TAG_NAME){var s=new i;s.parse.call(s,t,e.childNodes[r]),n.push(s)}return n}function Kn(t){return t=t.firstChild,t.nodeType!=Node.TEXT_NODE?null:t.nodeValue}function zn(t){return t?t.map(function(t){return t.clone()}):null}function Hn(t){return t?t.clone():null}function Gn(t,e,i,n){return t=i(t.getAttribute(e)),null!=t?t:void 0!==n?n:null}function Yn(t){return t?(t=Date.parse(t),isNaN(t)?null:Math.floor(t/1e3)):null}function Jn(e){if(!e)return null;var i=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(e);if(!i)return null;e=0;var n=Qn(i[1]);return n&&(e+=31536e3*n),(n=Qn(i[2]))&&(e+=2592e3*n),(n=Qn(i[3]))&&(e+=86400*n),(n=Qn(i[4]))&&(e+=3600*n),(n=Qn(i[5]))&&(e+=60*n),i=t.parseFloat(i[6]),(i=isNaN(i)?null:i)&&(e+=i),e}function $n(t){var e=/([0-9]+)-([0-9]+)/.exec(t);return e?(t=Qn(e[1]),null==t?null:(e=Qn(e[2]),null==e?null:new Dn(t,e))):null}function Wn(e){return e=t.parseInt(e,10),isNaN(e)?null:e}function Xn(e){return e=t.parseInt(e,10),e>0?e:null}function Qn(e){return e=t.parseInt(e,10),e>=0?e:null}function Zn(t){return t}function tr(t,e,i,n){for(var r=e.a,s=[],a=0;n>a;++a){var o=a+i,h=(o-1)*r.a,u=h/r.b,h=(h+r.a)/r.b,o=er(t,e,o-1+r.j,(o-1)*r.a);if(!o)return null;s.push(new Ie(u,h,o))}return s}function er(t,e,i,n){if(!e.a)return null;var r=e.a.h;return r?(i=ir(r,e.id,i,e.bandwidth,n))?(e=Pe(e.s,i),new ke(t,e,0,null)):null:e.s?new ke(t,e.s,0,null):null}function ir(e,i,n,r,s){var a={RepresentationID:i,Number:n,Bandwidth:r,Time:s};e=e.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(e,i,n){if("$$"==e)return"$";var r=a[i];return null==r?e:("RepresentationID"==i&&n&&(n=void 0),e=r.toString(),n=t.parseInt(n,10)||1,n=Math.max(0,n-e.length),Array(n+1).join("0")+e)});try{return new oe(e)}catch(o){if(o instanceof URIError)return null;throw o}}function nr(t,e,i){var n=0;e*=i,t=t.a,i=[];for(var r=0;r<t.length&&t[r].a;++r){var s=t[r].b,s=null!=s?s:n,a=t[r].c||0;0>a&&(a=t[r].a,a=r+1===t.length?Math.ceil((t[0].b+e-s)/a)-1:Math.ceil((t[r+1].b-s)/a)-1),0<i.length&&s!=n&&(i[i.length-1].end=s);for(var o=0;a>=o;++o)n=s+t[r].a,i.push({start:s,end:n}),s=n}return i}function rr(t,e){this.a=new ve,this.a.f="text",this.a.a=3,this.a.c=1e3*(null!=e?e:0),this.a.g=!0,this.b=t}function sr(t){var e=t.b;return Se(e,t.a).then(function(t){var i;return i=e.c,(i=(t=(new DOMParser).parseFromString(t,"text/xml"))?qn({s:i},t,vn):null)?Promise.resolve(i):(i=Error("MPD parse failure."),i.type="dash",Promise.reject(i))})}function ar(t,e,i,n,r){this.c=t,this.b=e,this.g=i,this.a=null,this.h=n,this.f=r}function or(t,e,i,n,r){var s,a=1,o=0;if(t.b>n)s=null;else{var h=t.i||0,u=t.f||0;s=i.a,s=s.a/s.b;var l=n-(t.b+e.start);0>l?s=null:(u=l-2*s-u,0>u&&(u=0),u=Math.ceil(u/s)*s,l-=s,0>l?s=null:(h=Math.floor(l/s)*s-h,0>h&&(h=0),h=Math.floor(h/s)*s,s={Na:u/s+1,current:(h>=u?h:u)/s+1}))}if(s&&(a=s.Na,o=s.current-s.Na+1),a=tr(r,i,a,o),null==a)throw t=Error("Failed to generate SegmentReferences."),t.type="stream",t;cn.call(this,a,t,e,n),this.l=i,this.i=this.b=0<this.length()?t.b+e.start+Oe(this).a:null,this.h=s?s.current+1:null,this.w=r}function hr(t,e){if(null!=t.b&&null!=t.i&&null!=t.h){var i=t.l.a,i=i.a/i.b,n=Math.floor((t.i+(e-t.v)-t.b)/i);if(0!=n){var r=tr(t.w,t.l,t.h,n);Array.prototype.push.apply(t.u,Ne(r,t.g)),t.b+=n*i,t.h+=n}}}function ur(t,e,i,n,r){this.f=t,this.b=e,this.c=i,this.h=n,this.a=null,this.g=r}function lr(t){this.a=t}function cr(t,e,i){for(var n=M()/1e3,r=0;r<e.a.length;++r)for(var s=e.a[r],a=0;a<s.b.length;++a){var o=s.b[a];if("text"!=o.contentType)for(var h=0;h<o.a.length;++h){var u=o.a[h],l=0,l=l+(u.g?1:0),l=l+(u.b?1:0),l=l+(u.a?1:0);0==l?(o.a.splice(h,1),--h):1!=l&&(u.g?(u.b=null,u.a=null):u.b&&(u.a=null))}}for(fr(e),r=0;r<e.a.length;++r)for(s=e.a[r],a=0;a<s.b.length;++a){for(h=o=s.b[a],u=null,l=0;l<h.a.length;++l){var c=h.a[l].f||"";u?c!=u&&(h.a.splice(l,1),--l):u=c}0==o.a.length&&(s.b.splice(a,1),--a)}for("dynamic"==e.type&&null==e.b&&(e.b=n),r=new He,"dynamic"==e.type&&(r.b=!0,r.f=e.g,r.g=new ke(i,e.j||e.url)),r.c=e.h||5,s=0;s<e.a.length&&(a=e.a[s],null!=a.start);++s)a=pr(t,e,a,n,i),r.a.push(a);return r}function fr(t){if(t.a.length){null==t.a[0].start&&(t.a[0].start=0);var e=function(t){return 0==t||!!t};"dynamic"==t.type&&(t.c=null),e(t.c)&&1==t.a.length&&!e(t.a[0].a)&&(t.a[0].a=t.c);for(var i=0,n=!0,r=0;r<t.a.length;++r){var s=t.a[r-1],a=t.a[r],o=t.a[r+1]||{start:t.c};!e(a.start)&&s&&e(s.start)&&e(s.a)&&(a.start=s.start+s.a),!e(a.a)&&e(o.start)&&(a.a=o.start-a.start),null!=a.start&&null!=a.a?i+=a.a:n=!1}e(t.c)||(r=t.a[t.a.length-1],n?t.c=i:e(r.start)&&e(r.a)?t.c=r.start+r.a:"dynamic"!=t.type&&(t.c=i))}}function pr(t,e,i,n,r){var s=new ze;s.id=i.id,s.start=i.start,s.b=i.a;var a=new I;i.b.forEach(function(t){a.push(t.contentType||"",t)});for(var o=N(a),h=0;h<o.length;++h){var u=new I;a.get(o[h]).forEach(function(t){u.push(t.group,t)});for(var l=N(u),c=0;c<l.length;++c){var f=new I;u.get(l[c]).forEach(function(t){f.push(t.lang,t)});for(var p=N(f),d=0;d<p.length;++d){var y=f.get(p[d]),y=dr(t,e,i,y,n,r);s.a.push(y)}}}return s}function dr(t,e,i,n,r,s){x(n.every(function(t){return t.group==n[0].group&&(t.lang||"")==(n[0].lang||"")&&(t.contentType||"")==(n[0].contentType||"")}));var a=new Ve,o=n.filter(function(t){return null!=t.id});o.length==n.length&&(a.id=o.map(function(t){return t.id}).sort().reduce(function(t,e){return t+","+e})),a.lang=n[0].lang||"",a.contentType=n[0].contentType||"",a.b=n.some(function(t){return t.c});for(var o={},h=0;h<n.length;++h)for(var u=n[h],l=0;l<u.a.length;++l){var c=u.a[l],f=vr(t,c),p=a.a.slice(0);br(f,p),0==p.length&&0<a.a.length||!(c=mr(e,i,c,r,s))||(a.m.push(c),a.a=p,o[c.A]=u)}if(a.a.some(function(t){return""==t.a}))return a.m.forEach(function(t){t.L=!0}),a;for(t=yr(n),h=0;h<a.m.length;++h)c=a.m[h],u=o[c.A],u==t&&(c.L=!0);return a}function yr(t){for(var e=null,i=null,n=0;n<t.length;++n)for(var r=t[n],s=0;s<r.a.length;++s){var a=r.a[s],a=(a.width||1)*(a.height||1)*(a.bandwidth||1);(null==e||e>a)&&(e=a,i=r)}return i}function br(t,e){if(0==e.length)Array.prototype.push.apply(e,t);else for(var i=0;i<e.length;++i){for(var n=!1,r=0;r<t.length;++r){var s=e[i],a=t[r];if(s.a==a.a&&s.j==a.j&&s.l==a.l&&s.h==a.h&&s.i==a.i&&s.g==a.g&&s.o==a.o&&s.f==a.f&&s.v==a.v&&E(s.c,a.c)){n=!0;break}}n||(e.splice(i,1),--i)}}function vr(t,e){var i=[];if(0==e.c.length)i.push(new C);else if(t.a)for(var n=0;n<e.c.length;++n)i.push.apply(i,gr(t,e.c[n]));return i}function gr(t,e){var i=[];if(2==t.a.length){var n=t.a(e.schemeIdUri,e.b);if(!(n&&n instanceof Array))return[];for(var r=0;r<n.length;++r){var s=D(n[r]);0==s.b.length&&e.pssh&&e.pssh.psshBox&&O(s,[{initData:e.pssh.psshBox,initDataType:"cenc"}]),i.push(s)}}else{if(n=t.a(e),!(n&&n instanceof U))return[];r=new C,r.a=n.g,r.j=n.j,r.l=n.o,r.h=n.h,r.i=n.i,r.g=n.f,r.o=n.v,r.f=n.c,r.v=n.l,r.c=n.b?new Uint8Array(n.b.buffer):null,O(r,n.a),i.push(r)}return i}function mr(t,e,i,n,r){if(!i.s||0===i.s.length)return null;var s=null,a=1,o=0;if(i.g)s=i.f.split("/")[1],"mp4"!=s&&"webm"!=s?s=null:(a=i.g,("webm"!=s||a.c)&&(a.a||a.b&&a.b.a)?(o=a.b,o||(o=new In,o.url=i.s,o.a=a.a?a.a.clone():null),o=Tr(o,r),a=a.c?Tr(a.c,r):null,t=new yn(t,e,s,o,a,n,r),e=new Ae(a),n=new qe,n.F=t,n.C=e,s=n):s=null),a=i.g.g,o=i.g.f;else if(i.b)s=i.b,!s.b&&!s.c&&1<s.a.length?s=null:s.b||e.a||s.c||1!=s.a.length?s.c&&0===s.c.a.length?s=null:(s=s.h?Tr(s.h,r):null,t=new ar(t,e,i,n,r),e=new Ae(s),n=new qe,n.F=t,n.C=e,s=n):s=null,a=i.b.f,o=i.b.g;else if(i.a){t:if(s=i.a,a=0+(s.f?1:0),a+=s.c?1:0,a+=s.a?1:0,0==a?a=!1:(1!=a&&(s.f?(s.c=null,s.a=null):s.c&&(s.a=null)),a=!0),a){if(a=null,s.g&&(a=(s=i.a.g)?wr(i,s,_n):null,!a)){s=null;break t}s=a?Tr(a,r):null,a=i.a,a.f?(a=i.f.split("/")[1],"mp4"!=a&&"webm"!=a?t=null:("webm"!=a||s)&&er(r,i,1,0)&&(o=(o=i.a.f)?wr(i,o,In):null)?(o=Tr(o,r),t=new yn(t,e,a,o,s,n,r)):t=null):t=a.h?a.c?new bn(t,e,i,n,r):a.a?"dynamic"!=t.type&&null==e.a?null:new ur(t,e,i,n,r):null:null,t?(e=new Ae(s),n=new qe,n.F=t,n.C=e,s=n):s=null}else s=null;a=i.a.b,o=i.a.i}else"text"==i.f.split("/")[0]&&(s=new qe,s.F=new Le(new ke(r,i.s)));if(!s)return null;for(s.id=i.id,o&&(s.c=-1*o/a),s.bandwidth=i.bandwidth,s.width=i.width,s.height=i.height,s.a=i.f||"",s.b=i.h||"",t=0;t<i.c.length;++t)e=i.c[t],e.a&&s.f.push(e.a);return s}function wr(t,e,i){return(e=ir(e,t.id,null,t.bandwidth,null))?(i=new i,i.url=Pe(t.s,e),i):null}function Tr(t,e){var i=t.url,n=0,r=null;return t.a&&(n=t.a.na,r=t.a.end),new ke(e,i,n,r)}function Er(t,e,i){e||(e=new G),i||(i=new Ci),Ui.call(this,null,e,i),this.T=t,this.M=[],this.timeoutMs=3e4,this.l={},this.j=this.O=null}function kr(t,e,i,n){var r=new rn(t.X,t);return null!=t.l.segmentRequestTimeout&&(r.b=Number(t.l.segmentRequestTimeout)),gt(r).then(u(t,function(){return sn(r,e,this.M,n,i)})).then(function(t){return mt(r),Promise.resolve(t)})["catch"](function(t){return mt(r),Promise.reject(t)})}function Pr(t){var e=new rn(null,null);return gt(e).then(u(t,function(){return an(e,this.T)})).then(function(){return mt(e),Promise.resolve()})["catch"](function(t){return mt(e),Promise.reject(t)})}function Sr(e){var i=document.createElement("video");i.src=t.URL.createObjectURL(e.g);var n=new hi(null,i,e);return null!=e.l.licenseRequestTimeout&&(n.w=Number(e.l.licenseRequestTimeout)),e.U().then(function(){return n.initialize()}).then(u(e,function(){return ui(n,this.timeoutMs)})).then(function(){return li(n)}).then(u(e,function(){return n.destroy(),this.destroy(),Promise.resolve()}))["catch"](u(e,function(t){return n.destroy(),this.destroy(),Promise.reject(t)}))}function jr(t,e,i,n){i||(i=new G),n||(n=new Ci),Ui.call(this,null,i,n),this.ka=t,this.M=e,this.l=[],this.O=[],this.T=[],this.j=null}var Ar,Ir=this;e("shaka.player.TextTrack.compare",function(t,e){return t.lang<e.lang?-1:t.lang>e.lang?1:0}),r.prototype.clone=function(){var t=new r;return t.maxHeight=this.maxHeight,t.maxWidth=this.maxWidth,t.maxBandwidth=this.maxBandwidth,t.minBandwidth=this.minBandwidth,t},e("shaka.player.VideoTrack.compare",a),e("shaka.player.AudioTrack.compare",function(t,e){return t.lang<e.lang?-1:t.lang>e.lang?1:t.bandwidth<e.bandwidth?-1:t.bandwidth>e.bandwidth?1:0}),h.prototype.destroy=function(){this["catch"](function(){});var t=Error("Destroyed!");t.type="destroy",this.reject(t)};var _r={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};e("shaka.util.Uint8ArrayUtils.toString",v),e("shaka.util.Uint8ArrayUtils.fromString",g),e("shaka.util.Uint8ArrayUtils.toBase64",m),e("shaka.util.Uint8ArrayUtils.fromBase64",w),e("shaka.util.Uint8ArrayUtils.fromHex",function(e){for(var i=new Uint8Array(e.length/2),n=0;n<e.length;n+=2)i[n/2]=t.parseInt(e.substr(n,2),16);return i}),e("shaka.util.Uint8ArrayUtils.toHex",T);var Rr;I.prototype.push=function(t,e){this.a.hasOwnProperty(t)?this.a[t].push(e):this.a[t]=[e]},I.prototype.get=function(t){return(t=this.a[t])?t.slice():null};var Nr=0;e("shaka.player.DrmSchemeInfo",U);var Mr=1;U.DistinctiveIdentifier={OPTIONAL:0,REQUIRED:Mr};var xr=1;U.PersistentState={OPTIONAL:0,REQUIRED:xr},U.createUnencrypted=function(){return new U("","",!1,null)},L.prototype.sample=function(t,e){var i=Math.pow(this.c,t);this.b=e*(1-i)+i*this.b,this.a+=t};var Cr=1,Dr=2,Or={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};e("shaka.util.FakeEventTarget",z),z.prototype.addEventListener=function(t,e,i){i||this.xa.push(t,e)},z.prototype.removeEventListener=function(t,e,i){i||R(this.xa,t,e)},z.prototype.dispatchEvent=function(t){return delete t.srcElement,delete t.target,delete t.currentTarget,Object.defineProperties(t,{srcElement:{value:null,writable:!0},target:{value:this,writable:!0},currentTarget:{value:null,writable:!0}}),H(this,t)},i(G,z),e("shaka.util.EWMABandwidthEstimator",G),G.prototype.sample=function(t,e){if(!(65536>e)){t=Math.max(t,50);var i=8e3*e/t,n=t/1e3;this.a.sample(n,i),this.c.sample(n,i),this.dispatchEvent(q({type:"bandwidth"})),this.b=Date.now()}},G.prototype.getBandwidth=function(){return.5>this.a.a?5e5:Math.min(B(this.a),B(this.c))},G.prototype.getDataAge=function(){return(Date.now()-this.b)/1e3},G.prototype.supportsCaching=function(){return!1};var Ur=0,Lr=1;tt.prototype.start=function(){if(this.f)throw Error("Task already started!");this.f=!0,this.b.unshift(function(){}),it(this,void 0)},tt.prototype.end=function(){this.b.splice(1)},rt.prototype.destroy=function(){at(this),this.a=null},rt.prototype.sa=function(t,e){for(var i=this.a.get(e)||[],n=0;n<i.length;++n){var r=i[n];r.target==t&&(r.sa(),R(this.a,e,r))}},ot.prototype.sa=function(){this.target&&(this.target.removeEventListener(this.type,this.a,!1),this.a=this.target=null)};var Br=1/60;ht.prototype.destroy=function(){pt(this)["catch"](function(){}),this.f&&this.f.destroy(),this.b=this.a=this.f=null,this.h.destroy(),this.j=this.c=this.h=null},ht.prototype.g=function(){"open"==this.j.readyState&&this.c.abort()},ht.prototype.w=function(){this.f.resolve(),this.f=null},i(vt,z),i(jt,vt),Nt("error"),Nt("warn"),Nt("info"),Nt("log"),Nt("debug"),e("shaka.player.TextStyle",Mt),Mt.prototype.a=function(){var e=t.localStorage.getItem("ShakaPlayerTextStyle");if(e){var i;try{i=JSON.parse(e)}catch(n){return}if(i&&"object"==typeof i){var r,e=i;for(r in e)r in this&&(this[r]=e[r])}}},Mt.prototype.load=Mt.prototype.a,Mt.prototype.b=function(){t.localStorage.setItem("ShakaPlayerTextStyle",JSON.stringify(this))},Mt.prototype.store=Mt.prototype.b;var qr=[255,255,255],Fr=[0,0,0];Mt.StandardColors={WHITE:qr,BLACK:Fr,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var Vr=1;Mt.StandardOpacities={OPAQUE:Vr,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var Kr=[];Mt.EdgeStyles={NONE:Kr,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};var zr=t.performance&&t.performance.now?t.performance.now.bind(t.performance):Date.now,Hr={};e("shaka.polyfill.CustomEvent.install",Bt),e("shaka.polyfill.VideoPlaybackQuality.install",Ft),e("shaka.polyfill.Fullscreen.install",Kt),Yt.prototype.createSession=function(){},Yt.prototype.setServerCertificate=function(){},Jt.prototype.getConfiguration=function(){},Jt.prototype.createMediaKeys=function(){},Xt.prototype.createMediaKeys=function(){var t=new Qt(this.a);return Promise.resolve(t)},Xt.prototype.getConfiguration=function(){return this.b},Ar=Qt.prototype,Ar.createSession=function(t){var e=t||"temporary";if("temporary"!=e&&"persistent-license"!=e)throw new TypeError("Session type "+t+" is unsupported on this platform.");return t=this.b||document.createElement("video"),t.src||(t.src="about:blank"),e=new ee(t,this.g,e),this.c.push(e),e},Ar.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))},Ar.Bb=function(t){t=q({type:"encrypted",initDataType:"webm",initData:t.initData}),this.b.dispatchEvent(t);
},Ar.Ab=function(t){var e=te(this,t.sessionId);e&&(t=q({type:"message",messageType:void 0==e.keyStatuses.a?"licenserequest":"licenserenewal",message:t.message}),e.b&&(e.b.resolve(),e.b=null),e.dispatchEvent(t))},Ar.yb=function(t){(t=te(this,t.sessionId))&&(ne(t,"usable"),t.a&&t.a.resolve(),t.a=null)},Ar.zb=function(t){var e=te(this,t.sessionId);if(e){var i=Error("EME v0.1b key error");i.errorCode=t.errorCode,i.errorCode.systemCode=t.systemCode,!t.sessionId&&e.b?(i.method="generateRequest",45==t.systemCode&&(i.message="Unsupported session type."),e.b.reject(i),e.b=null):t.sessionId&&e.a?(i.method="update",e.a.reject(i),e.a=null):(i=t.systemCode,t.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?ne(e,"output-restricted"):1==i?ne(e,"expired"):ne(e,"internal-error"))}},i(ee,z),Ar=ee.prototype,Ar.Ja=function(t,e){if(this.a)this.a.then(this.Ja.bind(this,t,e))["catch"](this.Ja.bind(this,t,e));else{this.a=t;var i,n;"webkit-org.w3.clearkey"==this.c?(i=v(new Uint8Array(e)),n=JSON.parse(i),"oct"!=n.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),i=w(n.keys[0].k),n=w(n.keys[0].kid)):(i=new Uint8Array(e),n=null);try{this.f.webkitAddKey(this.c,i,n,this.sessionId)}catch(r){this.a.reject(r),this.a=null}}},Ar.generateRequest=function(t,e){return ie(this,e,null)},Ar.load=function(t){return"persistent-license"==this.g?ie(this,null,t):Promise.reject(Error("Not a persistent session."))},Ar.update=function(t){var e=new h;return this.Ja(e,t),e},Ar.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId)}return this.closed.resolve(),this.closed},Ar.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()},re.prototype.next=function(){return this.a>=this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1}};var Gr;Ar=se.prototype,Ar.entries=function(){var t=Gr,e=[];return this.a&&e.push([t,this.a]),new re(e)},Ar.forEach=function(t){this.a&&t(this.a)},Ar.get=function(t){return this.has(t)?this.a:void 0},Ar.has=function(t){var e=Gr;return this.a&&E(new Uint8Array(t),e)?!0:!1},Ar.keys=function(){var t=Gr,e=[];return this.a&&e.push(t),new re(e)},Ar.values=function(){var t=[];return this.a&&t.push(this.a),new re(t)},e("shaka.polyfill.MediaKeys.install",ae),e("shaka.polyfill.installAll",function(){Bt(),Kt(),ae(),Ft()});var Yr=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;Ar=oe.prototype,Ar.R="",Ar.aa="",Ar.P="",Ar.fa=null,Ar.N="",Ar.$="",Ar.toString=function(){var t=[],e=this.R;if(e&&t.push(fe(e,Jr,!0),":"),e=this.P){t.push("//");var i=this.aa;i&&t.push(fe(i,Jr,!0),"@"),t.push(encodeURIComponent(e).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e=this.fa,null!=e&&t.push(":",String(e))}return(e=this.N)&&(this.P&&"/"!=e.charAt(0)&&t.push("/"),t.push(fe(e,"/"==e.charAt(0)?Wr:$r,!0))),(e=this.a.toString())&&t.push("?",e),(e=this.$)&&t.push("#",fe(e,Qr)),t.join("")},Ar.resolve=function(t){var e=this.clone();"data"===e.R&&(e=new oe);var i=!!t.R;i?he(e,t.R):i=!!t.aa,i?e.aa=t.aa:i=!!t.P,i?e.P=t.P:i=null!=t.fa;var n=t.N;if(i)ue(e,t.fa);else if(i=!!t.N){if("/"!=n.charAt(0))if(this.P&&!this.N)n="/"+n;else{var r=e.N.lastIndexOf("/");-1!=r&&(n=e.N.substr(0,r+1)+n)}if(".."==n||"."==n)n="";else if(-1!=n.indexOf("./")||-1!=n.indexOf("/.")){for(var r=0==n.lastIndexOf("/",0),n=n.split("/"),s=[],a=0;a<n.length;){var o=n[a++];"."==o?r&&a==n.length&&s.push(""):".."==o?((1<s.length||1==s.length&&""!=s[0])&&s.pop(),r&&a==n.length&&s.push("")):(s.push(o),r=!0)}n=s.join("/")}}return i?e.N=n:i=""!==t.a.toString(),i?le(e,t.a.clone()):i=!!t.$,i&&(e.$=t.$),e},Ar.clone=function(){return new oe(this)};var Jr=/[#\/\?@]/g,$r=/[\#\?:]/g,Wr=/[\#\?]/g,Xr=/[\#\?@]/g,Qr=/#/g;de.prototype.a=null,de.prototype.c=null,de.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";var t,e=[];for(t in this.a)for(var i=encodeURIComponent(t),n=this.a[t],r=0;r<n.length;r++){var s=i;""!==n[r]&&(s+="="+encodeURIComponent(n[r])),e.push(s)}return this.b=e.join("&")},de.prototype.clone=function(){var t=new de;if(t.b=this.b,this.a){var e,i={};for(e in this.a)i[e]=this.a[e].concat();t.a=i,t.c=this.c}return t},Ar=be.prototype,Ar.bb=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var e=this.url.split(":")[1].split(";").pop().split(","),i=e.pop(),i="base64"==e.pop()?t.atob(i.replace(/-/g,"+").replace(/_/g,"/")):t.decodeURIComponent(i);return"arraybuffer"==this.b.f&&(i=g(i).buffer),e=JSON.parse(JSON.stringify(new XMLHttpRequest)),e.response=i,e.responseText=i.toString(),i=this.c,i.resolve(e),ge(this),i}if(0==this.url.lastIndexOf("idb:",0))return we(this);this.h++,this.i=Date.now(),this.g||(this.g=this.b.h),this.a=new XMLHttpRequest,e=this.url,(this.f&&!this.f.supportsCaching()||this.b.g)&&(e=new oe(e),ye(e.a,"_",Date.now()),e=e.toString()),this.a.open(this.b.method,e,!0),this.a.responseType=this.b.f,this.a.timeout=this.b.c,this.a.withCredentials=this.b.i,this.a.onload=this.lb.bind(this),this.b.g&&(this.a.onreadystatechange=this.pb.bind(this)),this.a.onerror=this.Hb.bind(this),this.a.ontimeout=this.ub.bind(this);for(i in this.b.b)this.a.setRequestHeader(i,this.b.b[i]);return this.a.send(this.b.body),this.c},Ar.lb=function(t){this.f&&this.f.sample(Date.now()-this.i,t.loaded),200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),ge(this)):this.h<this.b.a?Ee(this):(t=Te(this,"HTTP error.","net"),this.c.reject(t),ge(this))},Ar.pb=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED){var t=Date.parse(this.a.getResponseHeader("Date"));t&&(Nr=t-Date.now())}},Ar.Hb=function(){var t=Te(this,"Network failure.","net");this.c.reject(t),ge(this)},Ar.ub=function(){if(this.h<this.b.a)Ee(this);else{var t=Te(this,"Request timed out.","net");this.c.reject(t),ge(this)}},ke.prototype.g=function(){if(this.b){this.a=null;var t=this.b;if(t.a&&t.a.readyState!=XMLHttpRequest.DONE){t.a.abort();var e=Te(t,"Request aborted.","aborted");t.c.reject(e),ge(t)}this.b=null}},ke.prototype.clone=function(){return new ke(this.i,this.c.map(function(t){return t.clone()}),this.f,this.h)},ke.prototype.toString=function(){return this.c[0].toString()},Ae.prototype.destroy=function(){this.a&&(this.a.g(),this.a=null)},Ae.prototype.create=function(){return this.a?Se(this.a):Promise.resolve(null)},Me.prototype.parse=function(t,e,i,n){var r=null;try{t:{var s=[],a=new Y(t),o=W(a);if(1936286840!=W(a))r=null;else{1==o&&(o=X(a));var h=$(a);Z(a,3),Z(a,4);var u=W(a);if(0==u)r=null;else{var l,c;0==h?(l=W(a),c=W(a)):(l=X(a),c=X(a)),Z(a,2);var f=a.b.getUint16(a.a,a.c);for(a.a+=2,t=l,e=e+o+c,o=0;f>o;o++){var p=W(a);c=(2147483648&p)>>>31;var h=2147483647&p,d=W(a);if(W(a),1==c){r=null;break t}var y=new ke(n,i,e,e+h-1);s.push(new Ie(t/u,(t+d)/u,y)),t+=d,e+=h}r=s}}}}catch(b){if(!(b instanceof RangeError))throw b}return r},xe.prototype.parse=function(t,e,i,n){var r=null;try{var s,a=new k(e);if(440786851!=P(a).id)s=null;else{var o=P(a);if(408125543!=o.id)s=null;else{var h,u=o.a.byteOffset,l=new k(o.a);for(e=null;J(l.a);){var c=P(l);if(357149030==c.id){e=c;break}}if(e){for(var f=new k(e.a),l=1e6;J(f.a);){var p=P(f);if(2807729==p.id){l=A(p);break}}h=l/1e9}else h=null;s=h?{Db:u,Ib:h}:null}}if(s){var d=P(new k(t));if(475249515!=d.id)r=null;else{var y=s.Db,b=s.Ib;t=[];var v=new k(d.a);for(s=d=-1;J(v.a);){var g=P(v);if(187==g.id){var m,w=new k(g.a),T=P(w);if(179!=T.id)m=null;else{var E=A(T),S=P(w);if(183!=S.id)m=null;else{for(var j=new k(S.a),u=0;J(j.a);){var I=P(j);if(241==I.id){u=A(I);break}}m={Kb:E,Cb:u}}}if(m){var _=b*m.Kb,R=y+m.Cb;if(d>=0){var N=new ke(n,i,s,R-1);t.push(new Ie(d,_,N))}d=_,s=R}}}d>=0&&(N=new ke(n,i,s,null),t.push(new Ie(d,null,N))),r=t}}else r=null}catch(M){if(!(M instanceof RangeError))throw M}return r},Ce.prototype.destroy=function(){this.u=null},Ar=Ce.prototype,Ar.length=function(){return this.u.length},Ar.get=function(t){if(0>t||t>=this.u.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.u[t]},Ar.ia=function(t){return t=Re(this.u,t),t>=0?this.u[t]:null},Ar.Ca=function(t){return Ue(this,t),!0},Ar.ha=function(t){var e=t-this.g;return 0==e?0:(this.u=Ne(this.u,e),this.g=t,e)},Ar.Ba=function(){return 0<this.length()?{start:De(this).b,end:Oe(this).a}:{start:0,end:0}},Le.prototype.destroy=function(){this.a&&(this.a.destroy(),this.a=null)},Le.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var t=new Ie(0,null,this.b);return this.a=new Ce([t]),Promise.resolve(this.a)},Be.prototype.destroy=function(){this.b=null,this.a&&(this.a.destroy(),this.a=null)},Be.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var t=[],e=0;e<this.b.length;++e){var i=this.b[e];t.push(new Ie(i.start_time,i.end_time,new ke(null,[new oe(i.url)],i.start_byte,null)))}return this.b=null,this.a=new Ce(t),Promise.resolve(this.a)};var Zr=0;qe.prototype.destroy=function(){this.F&&(this.F.destroy(),this.F=null),this.C&&(this.C.destroy(),this.C=null)};var ts=0;Ve.prototype.destroy=function(){for(var t=0;t<this.m.length;++t)this.m[t].destroy();this.a=this.m=null},ze.prototype.destroy=function(){for(var t=0;t<this.a.length;++t)this.a[t].destroy();this.a=null},He.prototype.destroy=function(){for(var t=0;t<this.a.length;++t)this.a[t].destroy();this.a=null},i(Ye,z),Ye.prototype.H=function(){},Ye.prototype.destroy=function(){this.a&&this.b.removeChild(this.a),this.c.destroy(),this.v=this.b=this.f=this.g=this.a=this.c=null},Ar=Ye.prototype,Ar.oa=function(){return this.f},Ar.Pa=function(){return this.g},Ar.cb=function(){return this.c},Ar.Qa=function(){return!0},Ar.ra=function(t){t.F.create().then(u(this,function(e){if(this.b){if(0==e.length())return Promise.reject(Error("No subtitles URL available."));var i=this.f;this.f=t,this.g=e,e=De(e).url.c[0].toString();var n=this.Aa();this.a&&(this.wa(!1),this.b.removeChild(this.a)),this.a=document.createElement("track"),this.b.appendChild(this.a),this.a.src=e,this.wa(n),e=q({type:"adaptation",bubbles:!0,contentType:"text",size:null,bandwidth:t.bandwidth}),this.dispatchEvent(e),i||this.c.resolve(0)}}))},Ar.Va=function(){},Ar.wa=function(t){this.h=t,this.a&&(this.a.track.mode=t?"showing":"disabled")},Ar.Aa=function(){return this.h},Ar.Fa=function(){return 0},i(Je,z),Je.prototype.H=function(t){null!=t.initialStreamBufferSize&&(this.K=Number(t.initialStreamBufferSize)),null!=t.streamBufferSize&&(this.w=Number(t.streamBufferSize)),null!=t.segmentRequestTimeout&&(this.a.l=Number(t.segmentRequestTimeout))},Je.prototype.destroy=function(){ei(this),this.h.destroy(),this.b=this.h=null,this.a.destroy(),this.v=this.c=this.a=null},Ar=Je.prototype,Ar.oa=function(){return this.b},Ar.Pa=function(){return this.D},Ar.cb=function(t){return this.f||t.then(function(){this.f=!0,this.g||ti(this,0)}.bind(this))["catch"](function(){}),this.h},Ar.Qa=function(){return this.j},Ar.ra=function(t,e,i){if(t!=this.b){var n=[t.F.create(),t.C.create()];Promise.all(n).then(u(this,function(n){if(this.c){var r=this.b;this.b=t,this.D=n[0],this.B=n[1],this.I=!0,this.l||(r?e&&$e(this,!0,i):ti(this,0))}}))["catch"](u(this,function(t){"aborted"!=t.type&&(this.f?(t=F(t),this.dispatchEvent(t)):this.h.reject(t))}))}},Ar.Va=function(){return $e(this,!1)},Ar.wa=function(){},Ar.Aa=function(){return!0},Ar.Fa=function(){return this.o?this.w:Math.min(this.K,this.w)},Ar.xb=function(){if(this.o&&!this.f)this.g=null;else{var t;if((t=this.f&&!this.j)&&(t=1<this.a.c.buffered.length?!0:!1),t)$e(this,!0);else{this.g=null,t=this.b;var e=this.D,i=this.c.currentTime;ut(this.a,this.o?i:i+(this.i||0))>=this.Fa()?(Xe(this),ti(this,1e3/(Math.abs(this.c.playbackRate)||1))):(e=We(this,i,e))?(e=lt(this.a,e,t.c,this.B),this.B=null,this.I&&(this.I=!1,Qe(this,t)),this.j=!1,e.then(u(this,function(t){null==this.i&&(this.i=t),this.G&&0<ut(this.a,i)&&(this.G=!1,this.c.currentTime+=.001),ti(this,0)}))["catch"](u(this,function(t){if("aborted"!=t.type){var e=[0,404,410];"net"==t.type&&-1!=e.indexOf(t.Lb.status)&&this.b&&ti(this,5e3),t=F(t),this.dispatchEvent(t)}}))):(Xe(this),this.f&&!this.j&&(this.j=!0,Ze(this)),ti(this,1e3))}}},i(hi,z),hi.prototype.destroy=function(){this.v=null;for(var e=0;e<this.f.length;++e)this.f[e].close()["catch"](function(){});this.f=[],this.j=this.a=this.h=null,this.c.destroy(),this.c=null,this.l.destroy(),this.l=null,this.i&&(t.clearTimeout(this.i),this.i=null),this.g=this.b=null},hi.prototype.initialize=function(){for(var t=new I,e=this.b.Oa(),i=0;i<e.length;++i){var n=e[i];n.a.a||n.b&&!gi(n.b)||t.push(n.contentType,n)}for(var i={},n=!1,r=0;r<e.length;++r){var s=e[r];if(s.a.a&&!t.a.hasOwnProperty(s.contentType)){var a=s.a.a,o=i[a];if(o||(o=s.a,o={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:o.g?"required":"optional",persistentState:o.o||this.b.ea()?"required":"optional",sessionTypes:[this.b.ea()?"persistent-license":"temporary"]},i[a]=o),s.b&&(a=s.contentType+"Capabilities",a in o)){n=!0,o[a]||(o[a]=[]);var u;"audio"==s.contentType?u=s.a.f:"video"==s.contentType&&(u=s.a.v),o[a].push({contentType:s.b,robustness:u})}}}if(!n){if(!e.length)throw t=Error("No DrmInfo exists!"),t.type="drm",t;this.a=e[0].a}return 0==Object.keys(i).length?(this.b.Ea(t),this.c.resolve(),Promise.resolve()):(u=new h,i=ci(this,i,u),i=i.then(this.hb.bind(this,e,t)),i=i.then(this.Eb.bind(this)),u.reject(null),i)},Ar=hi.prototype,Ar.hb=function(t,e,i){if(!this.g)return fi();for(var n=i.keySystem,r=i.getConfiguration(),s=["audio","video"],a=0;a<s.length;++a){var o=s[a];if(!e.a.hasOwnProperty(o)){var h=r[o+"Capabilities"];if(h&&h.length){for(var h=h[0],u=[],l={},c=0;c<t.length;++c){var f=t[c];if(f.a.a==n&&f.b==h.contentType&&!(f.id in l)){u.push(f),l[f.id]=!0;var p;if(this.a){p=this.a;var f=f.a,d=new C;d.a=p.a,d.j=p.j,d.l=p.l,d.h=p.h,d.i=p.i,d.g=p.g,d.o=p.o,d.f=p.f,d.v=p.v,d.c=p.c?new Uint8Array(p.c.buffer):null,O(d,p.b),O(d,f.b),p=d}else p=f.a;this.a=p}}e.a[o]=u}}}return this.b.Ea(e),i.createMediaKeys()},Ar.Eb=function(t){return this.g?(this.h=t,this.g.setMediaKeys(this.h).then(u(this,function(){return this.g?this.a.c?this.h.setServerCertificate(this.a.c):Promise.resolve():fi()})).then(u(this,function(){if(!this.g)return fi();if(0<this.b.va().length)pi(this);else{for(var t=0;t<this.a.b.length;++t){var e=this.a.b[t];this.Ra({type:"encrypted",initDataType:e.initDataType,initData:e.initData})}0==this.a.b.length&&st(this.l,this.g,"encrypted",this.Ra.bind(this))}}))):fi()},Ar.Ra=function(t){var e=new Uint8Array(t.initData),i=Array.prototype.join.apply(e);if(!this.j[i]){try{var n=di(this)}catch(r){return n=F(r),this.dispatchEvent(n),void this.c.reject(r)}t=n.generateRequest(t.initDataType,t.initData),this.j[i]=!0,t["catch"](u(this,function(t){if(this.j){this.j[i]=!1;var e=F(t);this.dispatchEvent(e),this.c.reject(t)}})),this.f.push(n)}},Ar.sb=function(t){yi(this,t.target,this.a,t.message)},Ar.kb=function(t){t=t.target.keyStatuses;for(var e={},i=t.keys(),n=i.next();!n.done;n=i.next()){var r=T(new Uint8Array(n.value)),n=t.get(n.value);e[r]=n}this.b.Sa(e)},i(vi,z),e("shaka.player.Player",vi),vi.version="v1.5.1",vi.isBrowserSupported=function(){return!!(t.MediaSource&&t.MediaKeys&&t.navigator&&t.navigator.requestMediaKeySystemAccess&&t.MediaKeySystemAccess&&t.MediaKeySystemAccess.prototype.getConfiguration&&t.Promise&&Element.prototype.requestFullscreen&&document.exitFullscreen&&"fullscreenElement"in document&&t.Uint8Array)},vi.isTypeSupported=gi,vi.setTextStyle=function(t){var e=document.getElementById("ShakaPlayerTextStyle");for(e||(e=document.createElement("style"),e.id="ShakaPlayerTextStyle",document.head.appendChild(e)),e=e.sheet;e.cssRules.length;)e.deleteRule(0);e.insertRule("::cue { "+xt(t)+" }",0)},vi.prototype.destroy=function(){return this.w().then(u(this,function(){this.f.destroy(),this.a=this.f=null}))["catch"](function(){})},vi.prototype.destroy=vi.prototype.destroy,vi.prototype.w=function(){if(!this.b)return Promise.resolve();this.i&&ki(this),this.a.pause(),at(this.f),Ei(this),wi(this),this.l&&(this.l.destroy(),this.l=null),this.a.src="";var t=this.a.setMediaKeys(null);return this.b&&(this.b.destroy(),this.b=null),this.i=!1,this.g=new ii,t},vi.prototype.unload=vi.prototype.w,vi.prototype.ma=function(t){var e=this.w();return this.a.autoplay&&(Ot("load"),st(this.f,this.a,"timeupdate",this.jb.bind(this))),t.I(this.c),t.$a(this.D),this.D=null,e=e.then(u(this,function(){return t.U()})),e["catch"](u(this,function(e){return t.destroy(),Promise.reject(e)})),e.then(u(this,function(){return this.a?(this.b=t,st(this.f,this.b,"seekrangechanged",this.qb.bind(this)),this.l=new hi(this,this.a,this.b),this.l.initialize()):mi()})).then(u(this,function(){return this.a?(st(this.f,this.a,"error",this.Fb.bind(this)),st(this.f,this.a,"playing",this.ob.bind(this)),st(this.f,this.a,"pause",this.nb.bind(this)),this.b.Ka(this,this.a)):mi()})).then(u(this,function(){return this.a?void Ti(this):mi()}))["catch"](u(this,function(t){if(!this.a)return mi();if("destroy"!=t.type){var e=F(t);this.dispatchEvent(e)}return this.w().then(function(){return Promise.reject(t)})}))},vi.prototype.load=vi.prototype.ma,Ar=vi.prototype,Ar.jb=function(){Ut("load"),this.g.playbackLatency=Lt("load")/1e3,this.f.sa(this.a,"timeupdate")},Ar.Fb=function(){if(this.a.error){var t=this.a.error.code;t!=MediaError.MEDIA_ERR_ABORTED&&(t=Error(es[t]||"Unknown playback error."),t.type="playback",t=F(t),this.dispatchEvent(t))}},Ar.ob=function(){Ot("playing"),!this.j&&0>this.o&&(this.a.playbackRate=0,this.G(this.a.currentTime,Date.now(),this.o)),this.i&&ki(this)},Ar.nb=function(){Ut("playing");var t=Lt("playing");if(!isNaN(t)){var e=this.g;e.playTime+=t/1e3}wi(this)},Ar.qb=function(t){this.H=t.start},Ar.ab=function(){if(!this.a.paused){Ut("playing");var t=Lt("playing");if(!isNaN(t)){var e=this.g;e.playTime+=t/1e3,Ot("playing")}}return t=this.g,e=this.a,e.getVideoPlaybackQuality&&(e=e.getVideoPlaybackQuality(),t.decodedFrames=e.totalVideoFrames,t.droppedFrames=e.droppedVideoFrames),this.g},vi.prototype.getStats=vi.prototype.ab,vi.prototype.la=function(){return this.b?this.b.ja():[]},vi.prototype.getVideoTracks=vi.prototype.la,vi.prototype.ta=function(){return this.b?this.b.pa():[]},vi.prototype.getAudioTracks=vi.prototype.ta,vi.prototype.ka=function(){return this.b?this.b.Ha():[]},vi.prototype.getTextTracks=vi.prototype.ka,vi.prototype.selectVideoTrack=function(t,e){return this.b?this.b.selectVideoTrack(t,void 0==e?!0:e):!1},vi.prototype.selectVideoTrack=vi.prototype.selectVideoTrack,vi.prototype.ya=function(t,e){return this.b?this.b.Ya(t,void 0==e?!0:e):!1},vi.prototype.selectAudioTrack=vi.prototype.ya,vi.prototype.fb=function(t){return this.b?this.b.Za(t,!1):!1},vi.prototype.selectTextTrack=vi.prototype.fb,vi.prototype.T=function(t){this.b&&this.b.Ga(t)},vi.prototype.enableTextTrack=vi.prototype.T,vi.prototype.K=function(t){this.h({enableAdaptation:t})},vi.prototype.enableAdaptation=vi.prototype.K,vi.prototype.S=function(){return this.c.enableAdaptation},vi.prototype.getAdaptationEnabled=vi.prototype.S,vi.prototype.da=function(t){this.h({streamBufferSize:t})},vi.prototype.setStreamBufferSize=vi.prototype.da,vi.prototype.X=function(){return Number(this.c.streamBufferSize)},vi.prototype.getStreamBufferSize=vi.prototype.X,vi.prototype.gb=function(t){this.h({licenseRequestTimeout:t/1e3})},vi.prototype.setLicenseRequestTimeout=vi.prototype.gb,vi.prototype.Z=function(t){this.h({mpdRequestTimeout:t/1e3})},vi.prototype.setMpdRequestTimeout=vi.prototype.Z,vi.prototype.M=function(t){this.h({segmentRequestTimeout:t/1e3})},vi.prototype.setRangeRequestTimeout=vi.prototype.M,vi.prototype.ca=function(t){this.h({preferredLanguage:t})},vi.prototype.setPreferredLanguage=vi.prototype.ca,vi.prototype.ba=function(t){wi(this),t>=0?this.a.playbackRate=t:this.a.paused||(this.a.playbackRate=0,this.G(this.a.currentTime,Date.now(),t)),this.o=t},vi.prototype.setPlaybackRate=vi.prototype.ba,vi.prototype.V=function(){return this.o},vi.prototype.getPlaybackRate=vi.prototype.V,vi.prototype.O=function(t){this.h({restrictions:t})},vi.prototype.setRestrictions=vi.prototype.O,vi.prototype.W=function(){return this.c.restrictions.clone()},vi.prototype.getRestrictions=vi.prototype.W,vi.prototype.eb=function(t){this.D=t},vi.prototype.setPlaybackStartTime=vi.prototype.eb,vi.prototype.I=function(){return this.b?this.b.Xa():!1},vi.prototype.isLive=vi.prototype.I,vi.prototype.h=function(t){if(t){var e=p(t,"enableAdaptation","boolean");null!=e&&(this.c.enableAdaptation=e),e=c(t,"streamBufferSize"),null!=e&&(this.c.streamBufferSize=e),e=c(t,"licenseRequestTimeout"),null!=e&&(this.c.licenseRequestTimeout=e),e=c(t,"mpdRequestTimeout"),null!=e&&(this.c.mpdRequestTimeout=e),e=c(t,"segmentRequestTimeout"),null!=e&&(this.c.segmentRequestTimeout=e),e=f(t,"preferredLanguage"),null!=e&&(this.c.preferredLanguage=e),t=d(t,"restrictions",r),null!=t&&(this.c.restrictions=t.clone()),this.b&&this.b.I(this.c)}},vi.prototype.configure=vi.prototype.h,vi.prototype.ua=function(){return this.c},vi.prototype.getConfiguration=vi.prototype.ua,vi.prototype.G=function(e,i,n){this.j=null;var r=(Date.now()-i)/1e3*n;this.a.currentTime<this.H+(this.I()?1:.05)?this.a.pause():(r=Math.max(this.H,e+r),this.a.currentTime=r,this.j=t.setTimeout(this.G.bind(this,e,i,n),250))},vi.prototype.Y=function(){if(Ti(this),!this.a.ended&&!this.a.seeking){var t=this.a.buffered,e=t.length?t.end(t.length-1):0,t=Math.max(e-this.a.currentTime,0);if(this.i)e=this.b.Wa(),t>e&&(ki(this),this.a.play());else{var i=this.a.duration,i=isNaN(i)?0:Math.max(i-.05,0),e=e>=i||this.a.currentTime>=i;!this.a.paused&&!e&&.2>t&&(this.i=!0,this.a.pause(),this.g.bufferingHistory.push(M()/1e3),Ot("buffering"),this.dispatchEvent(q({type:"bufferingStart"})))}}};var es={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};Ai.prototype.destroy=function(){this.a.destroy(),this.a=null},e("shaka.media.SimpleAbrManager",Ci),Ci.prototype.destroy=function(){this.f.destroy(),this.a=this.b=this.f=null},Ci.prototype.initialize=function(t,e){this.b||this.a||(this.b=t,this.a=e)},Ci.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=Date.now()+4e3,st(this.f,this.b,"bandwidth",this.v.bind(this)),st(this.f,this.a,"adaptation",this.j.bind(this)),st(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=!0)},Ci.prototype.enable=function(t){this.i=t},Ci.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var t=Di(this);return t?t.id:null},Ci.prototype.selectVideoTrack=function(t,e,i){this.g&&this.a.selectVideoTrack(t.id,e,i)},Ci.prototype.v=function(){Date.now()<this.c||this.h()},Ci.prototype.h=function(){if(this.i){var t=Di(this);if(t){if(t.active)return void(this.c=Date.now()+3e3);this.selectVideoTrack(t,!1)}this.c=Number.POSITIVE_INFINITY}},Ci.prototype.j=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=Date.now()+3e4)},i(Oi,z),e("shaka.player.HttpVideoSource",Oi),Oi.prototype.I=function(){},Oi.prototype.destroy=function(){this.a&&(this.a.parentElement.removeChild(this.a),this.a=null),this.v=this.b=null},Ar=Oi.prototype,Ar.Ka=function(t,e){this.v=t;var i=e.mediaKeys;return e.src=this.f,i=e.setMediaKeys(i),this.c&&(this.a=document.createElement("track"),this.a.src=this.c,e.appendChild(this.a),this.a.track.mode="showing"),i},Ar.U=function(){return Promise.resolve()},Ar.ja=function(){return[]},Ar.pa=function(){return[]},Ar.Ha=function(){return[]},Ar.Wa=function(){return 5},Ar.Oa=function(){var t=new Ge;return t.a=this.b,[t]},Ar.Ea=function(){},Oi.prototype.selectVideoTrack=function(){return!1},Ar=Oi.prototype,Ar.Ya=function(){return!1},Ar.Za=function(){return!1},Ar.Ga=function(t){this.a&&(this.a.track.mode=t?"showing":"disabled")},Ar.$a=function(){},Ar.va=function(){return[]},Ar.ea=function(){return!1},Ar.Xa=function(){return!1},Ar.Sa=function(t){for(var e in t){var i=t[e],n=_r[i]||null;if(n){var r=y(e),n=Error("Key "+r+" is not usable. "+n);n.type="drm",n.code=i,i=F(n),this.dispatchEvent(i)}}},i(Ui,z),e("shaka.player.StreamVideoSource",Ui),Ui.prototype.I=function(t){null!=t.streamBufferSize&&(this.S.streamBufferSize=t.streamBufferSize),null!=t.segmentRequestTimeout&&(this.S.segmentRequestTimeout=t.segmentRequestTimeout),nn(this),null!=t.enableAdaptation&&this.G.enable(Boolean(t.enableAdaptation)),null!=t.mpdRequestTimeout&&(this.ba=Number(t.mpdRequestTimeout)),null!=t.preferredLanguage&&(this.H=K(String(t.preferredLanguage))),null!=t.restrictions&&(this.h=t.restrictions,this.D&&Bi(this))},Ui.prototype.destroy=function(){this.w.destroy(),this.ca.destroy(),this.ca=this.w=null,this.W&&(t.clearTimeout(this.W),this.W=null),this.Z&&(t.clearTimeout(this.Z),this.Z=null),this.o=null,this.i.destroy(),this.i=null,l(this.c).forEach(function(t){t.destroy()}),this.b=this.c=null,this.a&&(this.a.destroy(),this.a=null),this.G.destroy(),this.v=this.h=this.K=this.f=this.g=this.X=this.G=null},Ar=Ui.prototype,Ar.Ka=function(e,i){if(!this.D){var n=Error("Cannot call attach() right now.");return n.type="app",Promise.reject(n)}return this.v=e,this.f=i,this.K=e.ab(),st(this.i,this.g,"sourceopen",this.mb.bind(this)),st(this.i,this.X,"bandwidth",this.Gb.bind(this)),n=this.f.mediaKeys,this.f.src=t.URL.createObjectURL(this.g),n=this.f.setMediaKeys(n),Promise.all([this.w,n])},Ar.U=function(){if(this.D){var t=Error("Cannot call load() right now.");return t.type="app",Promise.reject(t)}return this.a&&0!=this.a.a.length?(t=this.a.a,Pi(t),Si(t),0==this.a.a.length||0==this.a.a[0].a.length?(t=Error("The manifest specifies content that cannot be displayed on this browser/platform."),t.type="stream",Promise.reject(t)):(this.D=!0,this.S.initialStreamBufferSize=this.a.c,nn(this),Bi(this),Promise.resolve())):(t=Error("The manifest does not specify any content."),t.type="stream",Promise.reject(t))},Ar.vb=function(){var t=Date.now(),e=this.Z=null;this.Ta(this.a.g).then(u(this,function(t){return e=new Ai(t),Ii(e,this.a)})).then(u(this,function(i){e.destroy(),e=null;for(var n=0;n<i.length;++n)Li(this,i[n]);this.S.initialStreamBufferSize=this.a.c,nn(this),Bi(this),0==Object.keys(this.c).length?Ki(this):tn(this,(Date.now()-t)/1e3)}))["catch"](u(this,function(t){e&&(e.destroy(),e=null),"aborted"!=t.type&&(t=F(t),this.dispatchEvent(t),this.a&&tn(this,0))}))},Ar.Ta=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")},Ar.ja=function(){if(!this.b.a.hasOwnProperty("video"))return[];for(var t=this.c.video,t=(t=t?t.oa():null)?t.A:0,e=[],i=this.b.get("video"),n=0;n<i.length;++n)for(var r=i[n],a=0;a<r.m.length;++a){var o=r.m[a];if(o.L&&o.J){var h=o.A,o=new s(h,o.bandwidth,o.width,o.height);h==t&&(o.active=!0),e.push(o)}}return e},Ui.prototype.getVideoTracks=Ui.prototype.ja,Ui.prototype.pa=function(){if(!this.b.a.hasOwnProperty("audio"))return[];for(var t=this.c.audio,t=(t=t?t.oa():null)?t.A:0,e=[],i=this.b.get("audio"),n=0;n<i.length;++n)for(var r=i[n],s=r.lang,a=0;a<r.m.length;++a){var h=r.m[a];if(h.L&&h.J){var u=h.A,h=new o(u,h.bandwidth,s);u==t&&(h.active=!0),e.push(h)}}return e},Ui.prototype.getAudioTracks=Ui.prototype.pa,Ui.prototype.Ha=function(){if(!this.b.a.hasOwnProperty("text"))return[];for(var t=this.c.text,e=t?t.oa():null,e=e?e.A:0,i=[],r=this.b.get("text"),s=0;s<r.length;++s)for(var a=r[s],o=a.lang,h=0;h<a.m.length;++h){var u=a.m[h].A,l=new n(u,o);u==e&&(l.active=!0,l.enabled=t.Aa()),i.push(l)}return i},Ui.prototype.getTextTracks=Ui.prototype.Ha,Ui.prototype.Wa=function(){var t,e=null;for(t in this.c){var i=this.c[t].Fa();i>0&&(e=null!=e?Math.min(e,i):i)}return e||0},Ui.prototype.Oa=function(){var t;if(this.D){t=this.a.a[0];for(var e=[],i=0;i<t.a.length;++i)e.push.apply(e,Ke(t.a[i]));t=e}else t=[];return t},Ui.prototype.Ea=function(t){if(this.D){for(var e={},i=this.a.a[0],n=0;n<i.a.length;++n){var r=i.a[n];e[r.A]=r}for(this.b.a={},i=N(t),n=0;n<i.length;++n){var r=i[n],s=t.get(r);if("video"==r){var a=s[0].id;this.b.push(r,e[a])}else if("audio"==r)for(var a=s[0].b.split(";")[0],o=0;o<s.length;++o){var h=s[o];h.b.split(";")[0]==a&&this.b.push(r,e[h.id])}else for(o=0;o<s.length;++o)a=s[o].id,this.b.push(r,e[a])}this.da=!0,(t=this.b.get("audio"))&&(Vi(this,t),this.b.a.audio=t,t=t[0].lang||this.H,V(2,this.H,t)&&(this.da=!1)),(t=this.b.get("text"))&&(Vi(this,t),this.b.a.text=t,t=t[0].lang||this.H,V(2,this.H,t)||(this.da=!1))}},Ui.prototype.selectVideoTrack=function(t,e,i){return Fi(this,"video",t,e,i)},Ar=Ui.prototype,Ar.Ya=function(t,e){return Fi(this,"audio",t,e)},Ar.Za=function(t,e){return Fi(this,"text",t,e)},Ar.Ga=function(t){var e=this.c.text;e&&e.wa(t)},Ar.$a=function(t){this.Y=t},Ar.va=function(){return[]},Ar.ea=function(){return!1},Ar.Xa=function(){return this.a?this.a.b:!1},Ar.Sa=function(t){for(var e,i=!1,n=new I,r=_(this.b),s=0;s<r.length;++s)for(var a=r[s],o=0;o<a.m.length;++o){var h=a.m[o];h.f.forEach(function(t){n.push(t,h)})}for(e in t)if(r=_r[t[e]]||null,a=n.get(e))for(s=0;s<a.length;++s)h=a[s],o=h.L,h.L=!r,o!=h.L&&(i=!0);else y(e);i&&(qi(this),e=this.pa(),t=this.ja(),e=this.b.a.hasOwnProperty("audio")&&0==e.length,t=this.b.a.hasOwnProperty("video")&&0==t.length,e||t)&&(t=Error("The key system has restricted all "+(e&&t?"audio and video tracks.":e?"audio tracks.":"video tracks.")),t.type="drm",t=F(t),this.dispatchEvent(t))},Ar.mb=function(){this.i.sa(this.g,"sourceopen"),Ki(this).then(u(this,function(){this.w&&this.w.resolve()}))["catch"](u(this,function(t){this.w&&this.w.reject(t)}))},Ar.ib=function(t){x(t&&t.length==Object.keys(this.c).length);for(var e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,n=0;n<t.length;++n)var r=t[n],e=Math.min(e,r),i=Math.max(i,r);for(t=Qi(this),n=0;n<t.length;++n)t[n].ha(i);Ji(this,t,i),n=_(this.b).map(function(t){return t.m}).reduce(function(t,e){return t.concat(e)},[]).map(function(t){var e=[t.F.create()];return t.C&&e.push(t.C.create()),Promise.all(e)}),Promise.all(n).then(u(this,function(t){for(var e=0;e<t.length;++e)t[e][0].ha(i);this.ta=!0;for(var n in this.o)t=this.o[n],e=this.c[n],ni(this.K,t.Ia),e.ra(t.Ia,t.La,t.Ma);this.o={}}))["catch"](u(this,function(t){"aborted"!=t.type&&(t=F(t),this.dispatchEvent(t))}))},Ar.wb=function(){this.W=null,en(this);var t=Zi(this,Qi(this));t&&(Wi(this,t.start,t.end),this.f.paused||Xi(this,this.f.currentTime,t.start,t.end))},Ar.rb=function(){var t=this.f.currentTime;if(null!=this.B){if(t>=this.B-.01&&t<=this.B+.01)return void(this.B=null);this.B=null}var e=Zi(this,Qi(this));if(e){var i=e.end;if((e=Xi(this,t,e.start,i))||(i+.01>=t?e=!1:(this.f.currentTime=i,e=!0)),!e)for(var n in this.c)this.c[n].Va()}},Ar.tb=function(){if(!this.a.b){for(var t in this.c)if(!this.c[t].Qa())return;this.g.endOfStream()}},Ar.Gb=function(){var t=this.K,e=this.X.getBandwidth();t.estimatedBandwidth=e,t.bandwidthHistory.push(new si(e))},i(rn,vt),rn.prototype.g=function(t,e,i){var n=new h;t={stream_id:i.qa,mime_type:t.a,codecs:t.b,init_segment:e,references:i.u};var r=Et(this).put(t);return r.onsuccess=function(){n.resolve(i.qa)},r.onerror=function(){n.reject(r.error)},n},rn.prototype.f=function(t,e){for(var i=Promise.resolve(),n=0;n<t.length();++n)var r=t.get(n),s=n==t.length()-1,s=this.c.bind(this,r,e,s),i=i.then(this.i.bind(this,r)),i=i.then(s);return i.then(function(){return Promise.resolve(e)})["catch"](u(this,function(t){return ln(this,e.qa),Promise.reject(t)}))},rn.prototype.c=function(t,e,i,n){var r=new h;0==e.ga.byteLength&&(e.za=t),e.ga=un(e.ga,n),e.Ua++;var s=q({type:"progress",detail:e.Ua/e.Jb*100,bubbles:!0});if(1048576<=e.ga.byteLength||i){i={stream_id:e.qa,segment_id:e.Da,content:e.ga};var a=Tt(this).put(i);e.u.push({start_time:e.za.b,start_byte:e.za.url.f,end_time:t.a,url:"idb://"+e.qa+"/"+e.Da}),e.Da++,e.ga=new ArrayBuffer(0),a.onerror=function(){r.reject(a.error)},a.onsuccess=u(this,function(){this.dispatchEvent(s),r.resolve()})}else this.dispatchEvent(s),r.resolve();return r},rn.prototype.i=function(t){var e=new ve;return e.c=1e3*this.b,Se(t.url,e,this.j)},i(cn,Ce),
cn.prototype.destroy=function(){this.o=this.f=null,Ce.prototype.destroy.call(this)},cn.prototype.ia=function(t){return dn(this,M()/1e3),Ce.prototype.ia.call(this,t)},cn.prototype.Ca=function(t){return Ue(this,t),null==this.a&&fn(this),!0},cn.prototype.ha=function(t){return t=Ce.prototype.ha.call(this,t),null!=this.a&&(this.j+=t,this.c+=t,this.j>this.a&&(this.a+=t)),t},cn.prototype.Ba=function(){return pn(this,M()/1e3)},yn.prototype.destroy=function(){this.h=this.j=this.g=null,this.a.g(),this.a=null,this.c&&(this.c.g(),this.c=null),this.i&&(this.i.destroy(),this.i=null),this.b=null},yn.prototype.create=function(){if(this.b)return this.b;var t=[Se(this.a)];return"webm"==this.f&&t.push(Se(this.c)),this.b=Promise.all(t).then(u(this,function(t){var e=t[0];t=t[1]||null;var i=null;if("mp4"==this.f?(i=new Me,i=i.parse(new DataView(e),this.a.f,this.a.c,this.h)):"webm"==this.f&&(i=new xe,i=i.parse(new DataView(e),new DataView(t),this.a.c,this.h)),!i)return e=Error("Failed to parse SegmentReferences from "+this.a.toString()+" (or one of its fallbacks)."),e.type="stream",Promise.reject(e);var n;return n="dynamic"==this.g.type?new cn(i,this.g,this.j,this.v):new Ce(i),Promise.resolve(n)}))},bn.prototype.destroy=function(){this.g=this.f=this.c=this.b=null,this.a&&(this.a.destroy(),this.a=null)},bn.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var t=this.f.a,e=nr(t.c,t.b||1,this.c.a||0),i=[],n=0;n<e.length;++n){var r=e[n].start,s=r/t.b,a=e[n].end/t.b,r=er(this.g,this.f,n+t.j,r);if(!r)return t=Error("Failed to generate media URL."),t.type="dash",Promise.reject(t);var o=(t.i||0)/t.b;i.push(new Ie(s-o,a-o,r))}return"dynamic"==this.b.type?this.a=new cn(i,this.b,this.c,this.h):this.a=new Ce(i),Promise.resolve(this.a)},An.prototype.clone=function(){var t=new An;return t.s=zn(this.s),t.g=this.g,t.f=this.f,t.a=Hn(this.a),t.b=Hn(this.b),t.c=Hn(this.c),t},In.prototype.clone=function(){var t=new In;return t.url=zn(this.url),t.a=Hn(this.a),t},_n.prototype.clone=function(){var t=new _n;return t.url=zn(this.url),t.a=Hn(this.a),t},Rn.prototype.clone=function(){var t=new Rn;return t.s=zn(this.s),t.f=this.f,t.g=this.g,t.b=this.b,t.i=this.i,t.h=Hn(this.h),t.a=zn(this.a)||[],t.c=Hn(this.c),t},Nn.prototype.clone=function(){var t=new Nn;return t.b=zn(this.b),t.a=Hn(this.a),t},Mn.prototype.clone=function(){var t=new Mn;return t.b=this.b,t.i=this.i,t.a=this.a,t.j=this.j,t.h=this.h,t.f=this.f,t.g=this.g,t.c=Hn(this.c),t},xn.prototype.clone=function(){var t=new xn;return t.a=zn(this.a)||[],t},Cn.prototype.clone=function(){var t=new Cn;return t.b=this.b,t.a=this.a,t.c=this.c,t},Dn.prototype.clone=function(){return new Dn(this.na,this.end)},vn.TAG_NAME="MPD",gn.TAG_NAME="Period",mn.TAG_NAME="AdaptationSet",wn.TAG_NAME="Role",Tn.TAG_NAME="ContentComponent",En.TAG_NAME="Representation",kn.TAG_NAME="ContentProtection",Pn.TAG_NAME="cenc:pssh",Sn.TAG_NAME="BaseURL",jn.TAG_NAME="Location",An.TAG_NAME="SegmentBase",In.TAG_NAME="RepresentationIndex",_n.TAG_NAME="Initialization",Rn.TAG_NAME="SegmentList",Nn.TAG_NAME="SegmentURL",Mn.TAG_NAME="SegmentTemplate",xn.TAG_NAME="SegmentTimeline",Cn.TAG_NAME="S",vn.prototype.parse=function(t,e){this.url=t.s,this.id=Gn(e,"id",Zn),this.type=Gn(e,"type",Zn)||"static",this.c=Gn(e,"mediaPresentationDuration",Jn),this.h=Gn(e,"minBufferTime",Jn,this.h),this.g=Gn(e,"minimumUpdatePeriod",Jn,this.g),this.b=Gn(e,"availabilityStartTime",Yn,this.b),this.f=Gn(e,"timeShiftBufferDepth",Jn,this.f),this.i=Gn(e,"suggestedPresentationDelay",Jn,this.i);var i=t.s,n=Vn(this,e,Sn);this.s=Un(i,n),(n=qn(this,e,jn))&&(this.j=Ln(i,n.url)),this.a=Vn(this,e,gn)},gn.prototype.parse=function(t,e){this.id=Gn(e,"id",Zn),this.start=Gn(e,"start",Jn),this.a=Gn(e,"duration",Jn);var i=Vn(this,e,Sn);this.s=Un(t.s,i),this.c=qn(this,e,An),this.f=qn(this,e,Rn),this.g=qn(this,e,Mn),this.b=Vn(this,e,mn),On(this)},mn.prototype.parse=function(t,e){var i=qn(this,e,Tn)||{},n=qn(this,e,wn);this.id=Gn(e,"id",Zn),this.group=Gn(e,"group",Qn),this.lang=Gn(e,"lang",Zn,i.lang),this.contentType=Gn(e,"contentType",Zn,i.contentType),this.width=Gn(e,"width",Xn),this.height=Gn(e,"height",Xn),this.b=Gn(e,"mimeType",Zn),this.i=Gn(e,"codecs",Zn),this.c=n&&"main"==n.value,this.lang&&(this.lang=K(this.lang)),i=Vn(this,e,Sn),this.s=Un(t.s,i),this.j=Vn(this,e,kn),!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]),this.f=t.c?Bn(this,e,t.c):qn(this,e,An),this.g=t.f?Bn(this,e,t.f):qn(this,e,Rn),this.h=t.g?Bn(this,e,t.g):qn(this,e,Mn),this.a=Vn(this,e,En),!this.b&&this.a.length&&(this.b=this.a[0].f,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]))},wn.prototype.parse=function(t,e){this.value=Gn(e,"value",Zn)},Tn.prototype.parse=function(t,e){this.id=Gn(e,"id",Zn),this.lang=Gn(e,"lang",Zn),this.contentType=Gn(e,"contentType",Zn),this.lang&&(this.lang=K(this.lang))},En.prototype.parse=function(t,e){this.id=Gn(e,"id",Zn),this.bandwidth=Gn(e,"bandwidth",Xn),this.width=Gn(e,"width",Xn,t.width),this.height=Gn(e,"height",Xn,t.height),this.f=Gn(e,"mimeType",Zn,t.b),this.h=Gn(e,"codecs",Zn,t.i),this.lang=t.lang;var i=Vn(this,e,Sn);this.s=Un(t.s,i),this.c=Vn(this,e,kn),this.g=t.f?Bn(this,e,t.f):qn(this,e,An),this.b=t.g?Bn(this,e,t.g):qn(this,e,Rn),this.a=t.h?Bn(this,e,t.h):qn(this,e,Mn),0==this.c.length&&(this.c=t.j)},kn.prototype.parse=function(t,e){this.b=e,this.schemeIdUri=Gn(e,"schemeIdUri",Zn),this.value=Gn(e,"value",Zn);var i=Gn(e,"cenc:default_KID",Zn);i&&(this.a=i.replace(/[-]/g,"")),this.pssh=qn(this,e,Pn),this.children=Array.prototype.slice.call(e.childNodes)},Pn.prototype.parse=function(t,e){var i=Kn(e);if(i){this.psshBox=w(i);try{this.parsedPssh=new Dt(this.psshBox)}catch(n){if(!(n instanceof RangeError))throw n}}},Sn.prototype.parse=function(t,e){this.url=Kn(e)},jn.prototype.parse=function(t,e){this.url=Kn(e)},An.prototype.parse=function(t,e){this.s=t.s||this.s,this.g=Gn(e,"timescale",Xn,this.g),this.f=Gn(e,"presentationTimeOffset",Qn,this.f),this.a=Gn(e,"indexRange",$n,this.a),this.b=qn(this,e,In)||this.b,this.c=qn(this,e,_n)||this.c},In.prototype.parse=function(t,e){var i=Gn(e,"sourceURL",Zn);this.url=Ln(t.s,i),this.a=Gn(e,"range",$n,Hn(t.a))},_n.prototype.parse=function(t,e){var i=Gn(e,"sourceURL",Zn);this.url=Ln(t.s,i),this.a=Gn(e,"range",$n)},Rn.prototype.parse=function(t,e){this.s=t.s||this.s,this.f=Gn(e,"timescale",Xn,this.f),this.g=Gn(e,"presentationTimeOffset",Qn,this.g),this.b=Gn(e,"duration",Xn,this.b),this.i=Gn(e,"startNumber",Qn,this.i),this.h=qn(this,e,_n)||this.h;var i=Vn(this,e,Nn);this.a=i&&0<i.length?i:this.a,this.c=qn(this,e,xn)||this.c},Nn.prototype.parse=function(t,e){var i=Gn(e,"media",Zn);this.b=Ln(t.s,i),this.a=Gn(e,"mediaRange",$n)},Mn.prototype.parse=function(t,e){this.b=Gn(e,"timescale",Xn,this.b),this.i=Gn(e,"presentationTimeOffset",Qn,this.i),this.a=Gn(e,"duration",Xn,this.a),this.j=Gn(e,"startNumber",Qn,this.j),this.h=Gn(e,"media",Zn,this.h),this.f=Gn(e,"index",Zn,this.f),this.g=Gn(e,"initialization",Zn,this.g),this.c=qn(this,e,xn)||this.c},xn.prototype.parse=function(t,e){this.a=Vn(this,e,Cn)},Cn.prototype.parse=function(t,e){this.b=Gn(e,"t",Qn),this.a=Gn(e,"d",Qn),this.c=Gn(e,"r",Wn)},ar.prototype.destroy=function(){this.f=this.g=this.b=this.c=null,this.a&&(this.a.destroy(),this.a=null)},ar.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var t=this.g.b,e=[];t.c&&(e=nr(t.c,t.f||1,this.b.a||0));var i=0;t.b&&t.i?i=t.b*t.i:0<e.length&&(i=e[0].start-(t.g||0));var n=t.a.length;0<e.length&&e.length!=t.a.length&&(n=Math.min(e.length,t.a.length));for(var r=[],s=0;n>s;++s){var a=t.a[s],o=i/t.f,h=null,u=null;t.b?(h=i+t.b,u=h/t.f):0<e.length?(h=e[s].end-(t.g||0),u=h/t.f):(u=o+this.b.a,h=u*t.f);var i=h,h=0,l=null;a.a&&(h=a.a.na,l=a.a.end),r.push(new Ie(o,u,new ke(this.f,a.b,h,l)))}return"dynamic"==this.c.type?this.a=new cn(r,this.c,this.b,this.h):this.a=new Ce(r),Promise.resolve(this.a)},i(or,cn),or.prototype.destroy=function(){this.w=this.l=null,cn.prototype.destroy.call(this)},or.prototype.ia=function(t){var e=M()/1e3;return hr(this,e),dn(this,e),Ce.prototype.ia.call(this,t)},or.prototype.Ca=function(t){return null==this.b&&t instanceof or&&null!=t.b?(this.b=t.b,this.i=t.i,this.h=t.h,Ue(this,t),hr(this,M()/1e3),fn(this),!0):!1},or.prototype.ha=function(t){return t=cn.prototype.ha.call(this,t),null!=this.b&&(this.b+=t,this.i+=t),t},or.prototype.Ba=function(){var t=M()/1e3;return hr(this,t),pn(this,t)},ur.prototype.destroy=function(){this.g=this.c=this.b=this.f=null,this.a&&(this.a.destroy(),this.a=null)},ur.prototype.create=function(){if(this.a)return Promise.resolve(this.a);if("dynamic"==this.f.type)try{this.a=new or(this.f,this.b,this.c,this.h,this.g)}catch(t){return Promise.reject(t)}else{var e;if(e=this.c.a,e=tr(this.g,this.c,1,Math.ceil(this.b.a/(e.a/e.b)))){if(0<e.length){var i=e[e.length-1];e[e.length-1]=_e(i,i.b,this.b.a)}e=new Ce(e)}else e=null;if(this.a=e,!this.a)return e=Error("Failed to generate SegmentReferences"),e.type="stream",Promise.reject(e)}return Promise.resolve(this.a)},i(Er,Ui),e("shaka.player.OfflineVideoSource",Er),Er.prototype.I=function(t){null!=t.licenseRequestTimeout&&(this.l.licenseRequestTimeout=t.licenseRequestTimeout),null!=t.segmentRequestTimeout&&(this.l.segmentRequestTimeout=t.segmentRequestTimeout),Ui.prototype.I.call(this,t)},e("shaka.player.OfflineVideoSource.retrieveGroupIds",function(){var t=new jt,e=gt(t).then(function(){return At(t)});return e.then(function(){mt(t)})["catch"](function(){mt(t)}),e}),Er.prototype.ya=function(e,i,n,r){var s,a=null,o={},h=[];return e=new ke(this.O,[new oe(e)]),sr(new rr(e,this.ba)).then(u(this,function(t){return this.a=cr(new lr(n),t,this.O),this.a.b?(t=Error("Unable to store live streams offline."),t.type="app",Promise.reject(t)):(this.I({preferredLanguage:i}),Ui.prototype.U.call(this))})).then(u(this,function(){var e=document.createElement("video");return e.src=t.URL.createObjectURL(this.g),s=new hi(null,e,this),null!=this.l.licenseRequestTimeout&&(s.w=Number(this.l.licenseRequestTimeout)),st(this.i,s,"sessionReady",this.ka.bind(this)),st(this.i,s,"error",function(t){a=t}),s.initialize()})).then(u(this,function(){for(var t=_(this.b),e=0;e<t.length;++e)for(var i=t[e],n=0;n<i.m.length;++n){var s=i.m[n];o[s.A]=s}return r()})).then(u(this,function(t){for(var e=0;e<t.length;++e){var i=t[e],n=o[i];if(!n)return Promise.reject(Error("Invalid stream ID chosen: "+i));h.push(n)}var r=["audio","video"];return h=h.filter(function(t){return 0>r.indexOf(t.a.split("/")[0])?!1:!0}),t=h.map(function(t){return t.C.create()}),Promise.all(t)})).then(u(this,function(t){for(var e=h,i=[],n=0;n<e.length;++n)try{i[n]=this.g.addSourceBuffer(Fe(e[n]))}catch(r){}if(e.length!=i.length)t=Error("Error initializing streams."),t.type="storage",t=Promise.reject(t);else{for(n=0;n<t.length;++n)(e=t[n])&&i[n].appendBuffer(e);t=Promise.resolve()}return t})).then(u(this,function(){return ui(s,this.timeoutMs)})).then(u(this,function(){return a?Promise.reject(a):kr(this,h,s.a,this.a.a[0].b)})).then(u(this,function(t){return this.T=t,a?(Pr(this),Promise.reject(a)):Promise.resolve(t)}))},e("shaka.player.OfflineVideoSource.prototype.store",Er.prototype.ya),Er.prototype.ma=function(t){this.O=t},Er.prototype.setNetworkCallback=Er.prototype.ma,Er.prototype.ka=function(t){this.M.push(t.detail.sessionId)},Er.prototype.U=function(){var t,e,i=new jt;return gt(i).then(u(this,function(){return It(i,this.T)})).then(u(this,function(n){var r=[];this.M=n.session_ids,t=n.duration,e={keySystem:n.key_system,distinctiveIdentifierRequired:n.distinctive_identifier,persistentStorageRequired:!0,audioRobustness:n.audio_robustness,videoRobustness:n.video_robustness,withCredentials:n.with_credentials,licenseServerUrl:n.license_server};for(var s=0;s<n.stream_ids.length;++s)r.push(_t(i,n.stream_ids[s]));return Promise.all(r)})).then(u(this,function(i){var n=t,r=e,s=new He;s.c=5;for(var a=new ze,o=0;o<i.length;++o){var h=i[o],u=new qe,l=new Be(h.references),c=new Uint8Array(h.init_segment),c=new oe("data:application/octet-stream;base64,"+m(c)),c=new Ae(new ke(this.O,[c],0,null));u.F=l,u.C=c,u.a=h.mime_type,u.b=h.codecs,u.L=!0,this.j&&(null!=this.j.licenseServerUrl&&(r.licenseServerUrl=this.j.licenseServerUrl),null!=this.j.withCredentials&&(r.withCredentials=this.j.withCredentials),r.licensePostProcessor=this.j.licensePostProcessor,r.licensePreProcessor=this.j.licensePreProcessor,r.serverCertificate=this.j.serverCertificate),h=D(r),l=new Ve,l.m.push(u),l.a.push(h),l.contentType=u.a.split("/")[0],a.a.push(l),a.b=n}return s.a.push(a),this.a=s,Ui.prototype.U.call(this)})).then(function(){return mt(i),Promise.resolve()})["catch"](function(t){return mt(i),Promise.reject(t)})},Er.prototype.la=function(t,e){t&&(this.j={licenseServerUrl:t.licenseServerUrl,withCredentials:t.withCredentials,serverCertificate:t.serverCertificate,licensePreProcessor:t.licensePreProcessor,licensePostProcessor:t.licensePostProcessor});var i=null;return Sr(this)["catch"](function(t){return e?(i=t,Promise.resolve()):Promise.reject(t)}).then(u(this,function(){return Pr(this)})).then(function(){return Promise.resolve(i)})},Er.prototype.deleteGroup=Er.prototype.la,Er.prototype.va=function(){return this.M},Er.prototype.ea=function(){return!0},i(jr,Ui),e("shaka.player.DashVideoSource",jr),jr.prototype.la=function(t,e,i){this.l.push(t),this.O.push(e||""),this.T.push(i||"")},jr.prototype.addExternalCaptions=jr.prototype.la,jr.prototype.ma=function(t){this.j=t},jr.prototype.setNetworkCallback=jr.prototype.ma,jr.prototype.destroy=function(){this.j=this.M=null,Ui.prototype.destroy.call(this)},jr.prototype.U=function(){var t=new ke(this.j,[new oe(this.ka)]);return sr(new rr(t,this.ba)).then(u(this,function(t){for(var e=0;e<this.l.length;e++){var i=t,n=this.l[e],r=this.O[e],s=this.T[e];if(0!==i.a.length){var a=new mn;a.contentType="text",a.lang=r||"en",a.c=!0,r=new En,r.bandwidth=0,r.f=s||"text/vtt",r.s=[new oe(n)],a.a.push(r),i.a[0].b.push(a),On(i.a[0])}}return this.a=cr(new lr(this.M),t,this.j),Ui.prototype.U.call(this)}))},jr.prototype.Ta=function(t){return sr(new rr(t,this.ba)).then(u(this,function(t){return t=cr(new lr(this.M),t,this.j),Promise.resolve(t)}))}}).bind(r,this)(),"undefined"!=typeof t&&t.exports?t.exports=r.shaka:(n=function(){return r.shaka}.call(e,i,e,t),!(void 0!==n&&(t.exports=n)))}()},function(e,i){e.exports=t}])});